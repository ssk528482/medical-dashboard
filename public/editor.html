<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Syllabus & Qbank â€” Medical Study OS</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<nav class="side-nav" id="side-nav">
  <button class="side-nav-toggle" id="side-nav-toggle" title="Toggle sidebar">â®</button>
  <div class="side-nav-brand">
    <span class="side-nav-brand-icon">ğŸ©º</span>
    <span class="side-nav-brand-text">Medical OS</span>
  </div>
  <div class="side-nav-items">
    <a href="index.html"      class="side-nav-item "     data-label="Home">     <span class="side-nav-icon">ğŸ </span><span class="side-nav-label">Home</span></a>
    <a href="planner.html"    class="side-nav-item "  data-label="Planner">  <span class="side-nav-icon">ğŸ“…</span><span class="side-nav-label">Planner</span></a>
    <a href="editor.html"     class="side-nav-item active" data-label="Syllabus"> <span class="side-nav-icon">ğŸ“š</span><span class="side-nav-label">Syllabus</span></a>
    <a href="analytics.html"  class="side-nav-item "    data-label="Stats">    <span class="side-nav-icon">ğŸ“Š</span><span class="side-nav-label">Stats</span></a>
    <a href="profile.html"    class="side-nav-item "  data-label="Profile">  <span class="side-nav-icon">ğŸ‘¤</span><span class="side-nav-label">Profile</span></a>
    <a href="flashcards.html" class="side-nav-item "    data-label="Cards">    <span class="side-nav-icon">ğŸƒ</span><span class="side-nav-label">Cards</span><span class="side-nav-badge" id="nav-cards-badge" style="display:none"></span></a>
    <a href="notes.html"      class="side-nav-item "    data-label="Notes">    <span class="side-nav-icon">ğŸ“</span><span class="side-nav-label">Notes</span></a>
  </div>
</nav>
<script>
(function(){
  var nav = document.getElementById('side-nav');
  var btn = document.getElementById('side-nav-toggle');
  if (localStorage.getItem('navCollapsed') === '1') {
    nav.classList.add('collapsed');
    document.body.classList.add('nav-collapsed');
    if (btn) btn.textContent = 'â¯';
  }
  if (btn) btn.addEventListener('click', function() {
    var c = nav.classList.toggle('collapsed');
    document.body.classList.toggle('nav-collapsed', c);
    btn.textContent = c ? 'â¯' : 'â®';
    localStorage.setItem('navCollapsed', c ? '1' : '0');
  });
})();
</script>

<script src="router.js"></script>

<h1>ğŸ“š Syllabus & Qbank</h1>

<!-- Tab Bar -->
<div class="tab-bar">
  <button class="tab-btn active" id="tabEditor" onclick="switchTab('editor')">ğŸ“š Syllabus</button>
  <button class="tab-btn" id="tabQbank" onclick="switchTab('qbank')">ğŸ§ª Qbank</button>
</div>

<!-- â”€â”€ Editor Tab â”€â”€ -->
<div id="editorTab">
<div class="card">
  <div class="section-title">
    <button class="collapse-btn" onclick="toggleaddSubjectCollapse(this, 'newSubjectContent')">â–¶</button>
    Add New Subject
  </div>
  
  <div id="newSubjectContent" style="display: none;">
    <input id="newSubjectName" placeholder="Subject Name" style="width:100%;">
    <select id="newSubjectSize" style="width:100%;">
      <option value="large">Large</option>
      <option value="medium">Medium</option>
      <option value="small">Small</option>
    </select>
    <div style="display:flex;gap:8px;margin-top:8px;">
      <button onclick="addNewSubject()" style="flex:1;">Add Subject</button>
      <button onclick="openBulkModal()" style="flex:1;background:#8b5cf6;">ğŸ“¥ Bulk Import</button>
    </div>
  </div>
</div>

  <div id="editorContainer" style="padding:0 14px;"></div>
</div>

<!-- â”€â”€ Qbank Tab â”€â”€ -->
<div id="qbankTab" style="display:none;">
  <div class="card" style="font-size:13px;color:#94a3b8;">
    ğŸ“Š Track Qbank progress per unit. Log questions after each session.
  </div>
  <div id="qbankContainer" style="padding:0 14px;"></div>
</div>

<!-- â”€â”€ Bulk Import Modal â”€â”€ -->
<div id="bulkModal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.75);z-index:999;overflow-y:auto;padding:20px;">
  <div style="background:#1e293b;border:1px solid #334155;border-radius:16px;max-width:500px;margin:0 auto;padding:24px;">

    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
      <div style="font-size:16px;font-weight:700;">ğŸ“¥ Bulk Import Subjects</div>
      <button onclick="closeBulkModal()" style="background:#334155;padding:6px 12px;margin:0;font-size:13px;">âœ• Close</button>
    </div>

    <!-- Step dots -->
    <div style="display:flex;align-items:center;justify-content:center;gap:0;margin-bottom:20px;">
      <div id="bDot1" style="width:28px;height:28px;border-radius:50%;background:#3b82f6;border:2px solid #3b82f6;color:white;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;">1</div>
      <div id="bLine1" style="width:60px;height:2px;background:#334155;"></div>
      <div id="bDot2" style="width:28px;height:28px;border-radius:50%;background:#1e293b;border:2px solid #334155;color:#64748b;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;">2</div>
    </div>

    <!-- Step 1 -->
    <div id="bulkStep1">
      <label style="font-size:11px;color:#64748b;text-transform:uppercase;letter-spacing:.06em;display:block;margin-bottom:4px;">Subject Name</label>
      <input type="text" id="bulkSubjectName" placeholder="e.g. Anatomy" style="width:100%;margin-bottom:10px;">

      <label style="font-size:11px;color:#64748b;text-transform:uppercase;letter-spacing:.06em;display:block;margin-bottom:4px;">Size</label>
      <select id="bulkSubjectSize" style="width:100%;margin-bottom:10px;">
        <option value="large">Large</option>
        <option value="medium">Medium</option>
        <option value="small">Small</option>
      </select>

      <div style="background:#0f172a;border-radius:10px;padding:10px;margin-bottom:10px;">
        <div style="font-size:12px;color:#94a3b8;margin-bottom:8px;font-weight:600;">ğŸ“‹ Units & Topics</div>
        <div style="font-size:11px;color:#64748b;margin-bottom:8px;line-height:1.7;">
          Format per line:<br>
          <code style="background:#1e293b;padding:2px 5px;border-radius:4px;">Unit [Qs] | Chapter(start-end), Chapter(start-end)</code><br>
          <span style="color:#8b5cf6;">â€¢ <code style="background:#1e293b;padding:1px 4px;border-radius:3px;">[180]</code> = total questions in unit (optional)</span><br>
          <span style="color:#3b82f6;">â€¢ <code style="background:#1e293b;padding:1px 4px;border-radius:3px;">(1-42)</code> = page range (optional)</span><br>
          <span style="color:#64748b;">â€¢ Plain name with no pages/Qs also works</span>
        </div>
        <textarea id="bulkTopicsInput" rows="8" placeholder="Upper Limb [180] | Bones(1-42), Muscles(43-67), Nerves(68-95)&#10;Lower Limb [160] | Hip Joint(1-30), Knee(31-55), Ankle(56-80)&#10;Head &amp; Neck [220] | Scalp(1-18), Face(19-40)&#10;Thorax | Heart, Lungs&#10;Abdomen" style="width:100%;margin-bottom:0;font-family:monospace;font-size:12px;"></textarea>
      </div>

      <button onclick="bulkAddSubject()" style="width:100%;background:#8b5cf6;">+ Add Subject</button>

      <div id="bulkPreview" style="display:none;margin-top:14px;">
        <div style="font-size:11px;color:#64748b;text-transform:uppercase;letter-spacing:.06em;margin-bottom:8px;">SUBJECTS TO IMPORT</div>
        <div id="bulkPreviewList" style="background:#0f172a;border-radius:10px;padding:10px;max-height:200px;overflow-y:auto;"></div>
      </div>

      <button id="bulkNextBtn" onclick="bulkGoStep2()" style="width:100%;background:#16a34a;margin-top:12px;display:none;">
        Review & Import â†’
      </button>
    </div>

    <!-- Step 2 -->
    <div id="bulkStep2" style="display:none;">
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:14px;">
        <div style="background:#0f172a;border-radius:10px;padding:12px;text-align:center;">
          <div id="bulkSummarySubjects" style="font-size:28px;font-weight:800;color:#8b5cf6;">0</div>
          <div style="font-size:11px;color:#64748b;">Subjects</div>
        </div>
        <div style="background:#0f172a;border-radius:10px;padding:12px;text-align:center;">
          <div id="bulkSummaryTopics" style="font-size:28px;font-weight:800;color:#3b82f6;">0</div>
          <div style="font-size:11px;color:#64748b;">Total Units</div>
        </div>
      </div>
      <div id="bulkReviewList" style="background:#0f172a;border-radius:10px;padding:10px;max-height:200px;overflow-y:auto;margin-bottom:14px;"></div>
      <div style="display:flex;gap:8px;">
        <button onclick="bulkGoStep1()" style="flex:1;background:#334155;margin:0;">â† Back</button>
        <button onclick="bulkConfirmImport()" style="flex:1;background:#16a34a;margin:0;">ğŸš€ Import All</button>
      </div>
    </div>

  </div>
</div>

<!-- Bottom Nav -->


<script src="utils.js"></script>
<script src="data.js"></script>
<script src="revisionEngine.js"></script>
<script src="editor.js"></script>
<script src="supabase.js"></script>
<script src="cardSync.js"></script>
<script src="noteSync.js"></script>
<script>
  // Read URL param to decide which tab to show on load
  document.addEventListener("DOMContentLoaded", () => {
    let tab = new URLSearchParams(window.location.search).get("tab") || "editor";
    // Highlight active nav
    if (tab === "qbank") {
      document.getElementById("navQbank").classList.add("active");
      document.getElementById("navEditor").classList.remove("active");
    }
    switchTab(tab);
  });
</script>

</body>
</html>
