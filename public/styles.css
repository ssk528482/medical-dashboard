/* ═══════════════════════════════════════════════════════════
   Medical Study OS — Responsive UI
   Mobile-first, scales cleanly to 1440px desktop
   ═══════════════════════════════════════════════════════════ */

/* ─── Custom Properties ──────────────────────────────────── */
:root {
  --bg:        #0a1628;
  --surface:   #111f38;
  --card:      #152030;
  --border:    #1e3350;
  --border-lt: #2a4468;
  --text:      #e2e8f0;
  --text-muted:#7a90b0;
  --text-dim:  #445870;
  --blue:      #3b82f6;
  --purple:    #8b5cf6;
  --green:     #10b981;
  --yellow:    #f59e0b;
  --red:       #ef4444;
  --radius-sm: 8px;
  --radius:    12px;
  --radius-lg: 16px;
  --shadow-sm: 0 2px 12px rgba(0,0,0,0.3);
  --shadow:    0 4px 24px rgba(0,0,0,0.45);
  --nav-w:     220px;
  --nav-w-col:  64px;
}

/* ─── Base ────────────────────────────────────────────────── */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

html { scroll-behavior: smooth; }

body {
  font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI',
               'Inter', sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  -webkit-font-smoothing: antialiased;
  margin-left: 0;
}

/* ─── Content max-width centering ────────────────────────── */
body > *:not(.side-nav):not(#nav-overlay):not(#nav-toggle-btn) {
  max-width: 900px;
  margin-left: auto;
  margin-right: auto;
}

/* ═══════════════════════════════════════════════════════════
   SIDE NAV — Overlay drawer (hides fully, overlays on open)
   ═══════════════════════════════════════════════════════════ */

/* Dim backdrop */
#nav-overlay {
  display: block;
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.7);
  z-index: 199;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.28s ease;
}
#nav-overlay.open { opacity: 1; pointer-events: auto; }

/* Single sliding tab handle — attached to right edge of nav */
#nav-toggle-btn {
  position: fixed;
  top: 30px;
  left: 0;
  z-index: 210;
  width: 32px;
  height: 64px;
  min-height: unset;
  padding: 0;
  margin: 0;
  background: #1e3a5f;
  border: 1px solid rgba(59,130,246,0.45);
  border-left: none;
  border-radius: 0 10px 10px 0;
  color: #93c5fd;
  font-size: 9px;
  font-weight: 800;
  letter-spacing: 0.06em;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 3px;
  cursor: pointer;
  transition: left 0.28s cubic-bezier(.4,0,.2,1), background 0.15s, color 0.15s, box-shadow 0.15s;
  box-shadow: 2px 0 12px rgba(59,130,246,0.25), 2px 0 4px rgba(0,0,0,0.5);
  line-height: 1;
  user-select: none;
}
#nav-toggle-btn .ntb-label { font-size: 8px; font-weight: 800; letter-spacing: 0.1em; line-height: 1; }
#nav-toggle-btn .ntb-arrow { font-size: 12px; line-height: 1; font-weight: 400; }
#nav-toggle-btn.open { left: var(--nav-w); background: #1e3a5f; }
#nav-toggle-btn:hover { color: #fff; background: #2563eb; box-shadow: 2px 0 16px rgba(59,130,246,0.55), 2px 0 4px rgba(0,0,0,0.5); }

.side-nav {
  position: fixed;
  top: 0; left: 0; bottom: 0;
  width: var(--nav-w);
  background: rgba(10,18,36,0.98);
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
  border-right: 1px solid var(--border);
  display: flex;
  flex-direction: column;
  z-index: 200;
  overflow: hidden;
  transform: translateX(-100%);
  transition: transform 0.28s cubic-bezier(.4,0,.2,1);
  box-shadow: 2px 0 24px rgba(0,0,0,0.45);
}
.side-nav.open { transform: translateX(0); }

/* Close (✕) button inside the open nav — hidden, tab handle is used instead */
.side-nav-toggle { display: none; }

/* Brand row */
.side-nav-brand {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 16px 12px;
  border-bottom: 1px solid var(--border);
  overflow: hidden;
  white-space: nowrap;
  flex-shrink: 0;
  min-height: 50px;
}
.side-nav-brand-icon { font-size: 20px; flex-shrink: 0; width: 24px; display: flex; align-items: center; justify-content: center; }
.side-nav-brand-text {
  font-size: 13px; font-weight: 800;
  color: #f0f6ff; letter-spacing: -0.01em;
}

/* Nav items */
.side-nav-items {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 8px 0;
}
.side-nav-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 9px 16px;
  text-decoration: none;
  color: var(--text-muted);
  font-size: 13px;
  font-weight: 600;
  white-space: nowrap;
  position: relative;
  transition: color 0.15s, background 0.15s;
  overflow: hidden;
}
.side-nav-item:hover { color: var(--text); background: rgba(255,255,255,0.04); }
.side-nav-item.active {
  color: var(--blue);
  background: rgba(59,130,246,0.1);
}
.side-nav-item.active::before {
  content: '';
  position: absolute;
  left: 0; top: 20%; bottom: 20%;
  width: 3px;
  background: var(--blue);
  border-radius: 0 3px 3px 0;
}
.side-nav-icon { font-size: 18px; flex-shrink: 0; width: 28px; height: 28px; border-radius: 8px; text-align: center; display: flex; align-items: center; justify-content: center; transition: background 0.15s; }
.side-nav-icon svg { display: block; }
.side-nav-label { opacity: 1; }

/* Per-icon accent colours (inactive) */
.side-nav-item[data-label="Home"]     .side-nav-icon { color: #60a5fa; background: rgba(96,165,250,0.12); }
.side-nav-item[data-label="Planner"]  .side-nav-icon { color: #a78bfa; background: rgba(167,139,250,0.12); }
.side-nav-item[data-label="Syllabus"] .side-nav-icon { color: #34d399; background: rgba(52,211,153,0.12); }
.side-nav-item[data-label="Stats"]    .side-nav-icon { color: #fbbf24; background: rgba(251,191,36,0.12); }
.side-nav-item[data-label="Profile"]  .side-nav-icon { color: #38bdf8; background: rgba(56,189,248,0.12); }
.side-nav-item[data-label="Review"]   .side-nav-icon { color: #f87171; background: rgba(248,113,113,0.12); }
.side-nav-item[data-label="Cards"]    .side-nav-icon { color: #c084fc; background: rgba(192,132,252,0.12); }
.side-nav-item[data-label="Notes"]    .side-nav-icon { color: #2dd4bf; background: rgba(45,212,191,0.12); }

/* Active: saturate the icon bubble */
.side-nav-item.active[data-label="Home"]     .side-nav-icon { color: #3b82f6; background: rgba(59,130,246,0.22); }
.side-nav-item.active[data-label="Planner"]  .side-nav-icon { color: #8b5cf6; background: rgba(139,92,246,0.22); }
.side-nav-item.active[data-label="Syllabus"] .side-nav-icon { color: #10b981; background: rgba(16,185,129,0.22); }
.side-nav-item.active[data-label="Stats"]    .side-nav-icon { color: #f59e0b; background: rgba(245,158,11,0.22); }
.side-nav-item.active[data-label="Profile"]  .side-nav-icon { color: #0ea5e9; background: rgba(14,165,233,0.22); }
.side-nav-item.active[data-label="Review"]   .side-nav-icon { color: #ef4444; background: rgba(239,68,68,0.22); }
.side-nav-item.active[data-label="Cards"]    .side-nav-icon { color: #a855f7; background: rgba(168,85,247,0.22); }
.side-nav-item.active[data-label="Notes"]    .side-nav-icon { color: #14b8a6; background: rgba(20,184,166,0.22); }

/* Hover: slightly brighten icon bubble */
.side-nav-item:hover .side-nav-icon { filter: brightness(1.15); }

/* Badges */
.side-nav-badge {
  background: var(--red);
  color: #fff;
  font-size: 9px;
  font-weight: 800;
  border-radius: 10px;
  padding: 1px 5px;
  min-width: 16px;
  text-align: center;
  margin-left: auto;
  flex-shrink: 0;
}

/* Review nav item due-count badge */
.side-nav-review-badge {
  background: var(--red);
  color: #fff;
  font-size: 9px;
  font-weight: 800;
  border-radius: 10px;
  padding: 1px 5px;
  min-width: 16px;
  max-width: 34px;
  text-align: center;
  margin-left: auto;
  flex-shrink: 0;
  line-height: 1.4;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  align-self: center;
}

/* ─── Page Header / h1 ────────────────────────────────────── */
h1 {
  position: sticky;
  top: 0;
  z-index: 90;
  background: rgba(10, 22, 40, 0.94);
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
  border-bottom: 1px solid var(--border);
  padding: 14px 18px 13px;
  font-size: 17px;
  font-weight: 700;
  color: #f0f6ff;
  letter-spacing: -0.01em;
  display: flex;
  align-items: center;
  gap: 8px;
  border-left: 3px solid transparent;
  border-image: linear-gradient(180deg, var(--blue) 0%, var(--purple) 100%) 1;
}
h1::after {
  content: '';
  position: absolute;
  bottom: 0; left: 0; right: 0;
  height: 1px;
  background: linear-gradient(90deg, rgba(59,130,246,0.5) 0%, rgba(139,92,246,0.3) 60%, transparent 100%);
}

/* ─── Cards ───────────────────────────────────────────────── */
.card {
  background: var(--card);
  margin: 10px 14px;
  padding: 16px 18px;
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-sm);
  border: 1px solid var(--border);
  transition: border-color 0.2s, box-shadow 0.2s;
}

/* ─── Section Titles ──────────────────────────────────────── */
.section-title {
  font-size: 11px;
  font-weight: 700;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin-bottom: 14px;
  display: flex;
  align-items: center;
  gap: 6px;
}

/* ─── Buttons ─────────────────────────────────────────────── */
button {
  background: var(--blue);
  color: white;
  border: none;
  padding: 11px 16px;
  border-radius: var(--radius-sm);
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  margin-top: 8px;
  transition: opacity 0.15s, transform 0.1s, box-shadow 0.15s;
  font-family: inherit;
  letter-spacing: -0.01em;
  min-height: 44px;
}
button:hover  { opacity: 0.88; box-shadow: 0 4px 16px rgba(59,130,246,0.25); }
button:active { transform: scale(0.97); opacity: 1; }
button:disabled { opacity: 0.35; cursor: not-allowed; box-shadow: none; }

/* ─── Inputs ──────────────────────────────────────────────── */
input:not([type="checkbox"]):not([type="radio"]):not([type="file"]):not([type="range"]), select, textarea {
  width: 100%;
  background: var(--bg);
  color: var(--text);
  padding: 11px 12px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--border);
  font-size: 14px;
  font-family: inherit;
  margin: 4px 0;
  min-height: 44px;
  transition: border-color 0.15s, box-shadow 0.15s;
  -webkit-appearance: none;
  appearance: none;
}
select {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='7' viewBox='0 0 12 7'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%237a90b0' stroke-width='1.8' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 12px center;
  padding-right: 36px;
  cursor: pointer;
}
input:not([type="checkbox"]):not([type="radio"]):focus, select:focus, textarea:focus {
  outline: none;
  border-color: var(--blue);
  box-shadow: 0 0 0 3px rgba(59,130,246,0.14);
}
input[type="number"]                        { -moz-appearance: textfield; appearance: textfield; }
input[type="number"]::-webkit-outer-spin-button,
input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; }
textarea { min-height: 88px; resize: vertical; }

label {
  display: block;
  font-size: 11px;
  font-weight: 700;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.07em;
  margin-bottom: 4px;
}

/* ─── Progress Bars ───────────────────────────────────────── */
.stat-bar {
  height: 6px;
  background: rgba(255,255,255,0.05);
  border-radius: 20px;
  overflow: hidden;
  margin-top: 5px;
}
.stat-fill {
  height: 100%;
  border-radius: 20px;
  transition: width 0.7s cubic-bezier(.34,1.56,.64,1);
}
.green  { background: var(--green);  }
.yellow { background: var(--yellow); }
.red    { background: var(--red);    }

/* ─── Phase Grid ──────────────────────────────────────────── */
.phase-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
  margin-top: 4px;
}

.phase-item {
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 12px 8px;
  text-align: center;
}

.phase-label {
  font-size: 9px;
  color: var(--text-muted);
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.07em;
  line-height: 1.4;
}

.phase-pct   { font-size: 22px; font-weight: 900; margin: 5px 0 3px; letter-spacing: -0.02em; }
.phase-count { font-size: 10px; color: var(--text-dim); margin-top: 2px; }

/* ─── Phase Pill ──────────────────────────────────────────── */
.phase-pill {
  display: inline-block;
  padding: 2px 7px;
  border-radius: 4px;
  font-size: 10px;
  font-weight: 700;
  color: white;
}
.p1 { background: #1d4ed8; }
.p2 { background: #7c3aed; }
.p3 { background: #b45309; }

/* ─── Tab Bar ─────────────────────────────────────────────── */
.tab-bar {
  display: flex;
  margin: 10px 14px 8px;
  background: var(--card);
  border-radius: var(--radius);
  padding: 4px;
  border: 1px solid var(--border);
  gap: 4px;
}

.tab-btn {
  flex: 1;
  background: transparent;
  color: var(--text-muted);
  border: none;
  padding: 10px 14px;
  border-radius: var(--radius-sm);
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  margin-top: 0;
  min-height: 42px;
  font-family: inherit;
}
.tab-btn:hover  { color: var(--text); background: var(--border); opacity: 1; }
.tab-btn.active {
  background: var(--blue);
  color: white;
  box-shadow: 0 2px 12px rgba(59,130,246,0.3);
}

/* ─── Analytics Grid ──────────────────────────────────────── */
.analytics-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
  margin-bottom: 8px;
}

.stat-box {
  background: var(--bg);
  border-radius: var(--radius);
  padding: 14px 10px;
  text-align: center;
  border: 1px solid var(--border);
}

.stat-big {
  font-size: 24px;
  font-weight: 900;
  line-height: 1;
  margin-bottom: 5px;
  letter-spacing: -0.02em;
}

.stat-label {
  font-size: 11px;
  color: var(--text-muted);
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-top: 2px;
}

/* ─── Subject Cards (editor) ──────────────────────────────── */
.subject-card {
  background: var(--card);
  padding: 14px;
  margin-bottom: 12px;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  transition: border-color 0.2s;
}
.subject-card:hover { border-color: var(--border-lt); }

.subject-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.subject-title {
  font-size: 15px;
  font-weight: 700;
  color: #f0f6ff;
}

/* ─── Subject Summary Card (home) ─────────────────────────── */
.subject-summary-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 14px;
  margin: 0 14px 10px;
  transition: border-color 0.2s;
}
.subject-summary-card:hover { border-color: var(--border-lt); }

/* ─── Unit Block ──────────────────────────────────────────── */
.unit-block {
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 10px 10px 6px;
  margin-top: 8px;
}

.unit-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 6px;
}

.unit-title {
  font-size: 13px;
  font-weight: 600;
  color: #a8c0dc;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* ─── Chapter Row ─────────────────────────────────────────── */
.chapter-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 0;
  border-top: 1px solid var(--border);
  gap: 6px;
  flex-wrap: wrap;
}

@media (max-width: 480px) {
  .chapter-row { align-items: flex-start; }
  .chapter-row .topic-left    { flex-basis: 100%; }
  .chapter-row .topic-actions { flex-basis: 100%; padding-left: 2px; flex-wrap: wrap; }

  /* Unit header: title row full-width, button row wraps below flush-left */
  .unit-header > div:first-child { flex-basis: 100%; min-width: 0; }
  .unit-header > div:last-child  { flex-basis: 100%; justify-content: flex-start !important; }

  /* Always show edit pencil on touch (no hover) */
  .edit-name-btn { opacity: 0.75; }

  /* Inline rename: fill available width */
  .inline-rename-input { min-width: 0 !important; width: 100% !important; max-width: 100%; }

  /* Rev bars: hide % number to save space, keep bars */
  .rev-bar-pct { display: none; }

  /* Reorder buttons: larger touch target */
  .reorder-btn { padding: 4px 8px; min-height: 30px; }

  /* Subject header: allow full wrap */
  .subject-header { flex-wrap: wrap; align-items: flex-start; gap: 6px; }
  .subject-title  { flex: 1 1 100%; gap: 6px; }
}

/* ─── Qbank Unit Row ──────────────────────────────────────── */
.qbank-unit-row {
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 14px;
  margin-top: 10px;
}

/* ─── Topic Row ───────────────────────────────────────────── */
.topic-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 9px 0;
  border-top: 1px solid var(--border);
  gap: 6px;
}

.topic-left    { display: flex; align-items: center; gap: 8px; flex: 1; min-width: 0; }
.topic-name    { font-size: 13px; color: #a8c0dc; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.topic-actions { display: flex; gap: 4px; flex-shrink: 0; }

/* ─── Pills ───────────────────────────────────────────────── */
/* ── Editor: revision progress bars ─────────────────────────── */
.rev-bar-row {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 3px;
}
.rev-bar-label {
  font-size: 10px;
  font-weight: 700;
  width: 22px;
  flex-shrink: 0;
  text-align: right;
}
.rev-bar-track {
  flex: 1;
  height: 5px;
  background: #1e293b;
  border-radius: 3px;
  overflow: hidden;
}
.rev-bar-fill {
  height: 100%;
  border-radius: 3px;
  transition: width 0.3s;
}
.rev-bar-pct {
  font-size: 10px;
  color: #64748b;
  width: 30px;
  text-align: right;
  flex-shrink: 0;
}
/* ── Editor: inline rename input ────────────────────────────── */
.inline-rename-input {
  background: #0f172a;
  color: #f1f5f9;
  border: 1px solid #3b82f6;
  border-radius: 5px;
  padding: 2px 6px;
  outline: none;
  font-family: inherit;
}
/* ── Editor: edit-name pencil button ────────────────────────── */
.edit-name-btn {
  background: transparent;
  border: none;
  color: #475569;
  font-size: 11px;
  padding: 0 3px;
  margin: 0;
  cursor: pointer;
  line-height: 1;
  opacity: 0.6;
}
.edit-name-btn:hover { opacity: 1; color: #93c5fd; }
/* ── Editor: reorder up/down arrows ─────────────────────────── */
.reorder-btn {
  background: transparent;
  border: 1px solid #1e293b;
  color: #475569;
  font-size: 11px;
  padding: 2px 5px;
  border-radius: 5px;
  margin: 0;
  cursor: pointer;
  line-height: 1;
}
.reorder-btn:hover { border-color: #334155; color: #94a3b8; }
/* ── Editor: size badge ──────────────────────────────────────── */
.size-badge {
  font-size: 9px;
  font-weight: 700;
  padding: 1px 6px;
  border-radius: 5px;
  color: white;
  cursor: pointer;
  text-transform: uppercase;
  letter-spacing: .04em;
}
/* ── Editor: overdue chapter row ─────────────────────────────── */
.chapter-overdue {
  background: rgba(239,68,68,0.07);
  border-left: 2px solid #ef4444;
}

.pill {
  padding: 5px 8px;
  border-radius: 6px;
  font-size: 11px;
  font-weight: 600;
  cursor: pointer;
  background: rgba(255,255,255,0.04);
  color: var(--text-dim);
  border: 1px solid var(--border);
  transition: all 0.15s;
  user-select: none;
  white-space: nowrap;
  min-height: 30px;
  display: inline-flex;
  align-items: center;
}
.pill.completed.active { background: var(--green);  color: white; border-color: var(--green);  }
.pill.rev.active       { background: var(--blue);   color: white; border-color: var(--blue);   }
.pill.qbank.active     { background: var(--purple); color: white; border-color: var(--purple); }
.pill:hover { opacity: 0.78; }

/* ─── Accuracy Badges ─────────────────────────────────────── */
.accuracy-badge {
  padding: 3px 9px;
  border-radius: 5px;
  font-size: 11px;
  font-weight: 700;
  color: white;
}
.accuracy-low  { background: var(--red);    }
.accuracy-mid  { background: var(--yellow); color: #111; }
.accuracy-high { background: var(--green);  }

/* ─── Overdue Badge ───────────────────────────────────────── */
.badge-overdue {
  background: rgba(239,68,68,0.12);
  color: #fca5a5;
  border: 1px solid rgba(239,68,68,0.35);
  padding: 3px 8px;
  border-radius: 5px;
  font-size: 11px;
  font-weight: 700;
}

/* ─── Button Variants ─────────────────────────────────────── */
.delete-btn {
  background: rgba(239,68,68,0.1);
  color: var(--red);
  border: 1px solid rgba(239,68,68,0.25);
  padding: 6px 12px;
  font-size: 12px;
  font-weight: 600;
  margin-top: 0;
  min-height: 34px;
}
.delete-btn:hover { background: var(--red); color: white; box-shadow: none; }

.icon-btn {
  background: transparent;
  border: none;
  color: var(--text-dim);
  font-size: 14px;
  cursor: pointer;
  padding: 5px;
  margin-top: 0;
  border-radius: 6px;
  transition: color 0.15s, background 0.15s;
  min-height: auto;
}
.icon-btn:hover { color: var(--red); background: rgba(239,68,68,0.1); box-shadow: none; }

.collapse-btn {
  background: transparent;
  border: none;
  font-size: 11px;
  cursor: pointer;
  color: var(--text-dim);
  padding: 4px 7px;
  margin-top: 0;
  border-radius: 5px;
  transition: color 0.15s, background 0.15s;
  min-height: auto;
  touch-action: manipulation;   /* ← NEW: eliminates 300ms mobile tap delay */
  -webkit-tap-highlight-color: transparent; /* ← NEW: removes grey flash on tap */
}
.collapse-btn:hover { color: var(--text); background: var(--border); box-shadow: none; }


/* ─── Add Row ─────────────────────────────────────────────── */
.add-topic-row {
  margin: 10px 0;
  display: flex;
  gap: 8px;
  align-items: center;
}
.add-topic-row input  { flex: 1; margin: 0; }
.add-topic-row button {
  padding: 0 16px;
  margin-top: 0;
  font-size: 13px;
  white-space: nowrap;
  height: 44px;
}

/* ─── Editor/Qbank container padding ─────────────────────── */
#editorContainer, #qbankContainer {
  padding: 0 14px 8px;
}

/* ─── Bottom Navigation ───────────────────────────────────── */
/* ─── Scrollbar ───────────────────────────────────────────── */
::-webkit-scrollbar       { width: 4px; height: 4px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border-lt); border-radius: 4px; }

/* ─── Misc ────────────────────────────────────────────────── */
#authStatus    { font-size: 12px; color: var(--text-dim); }
#userGreeting  { font-size: 15px; font-weight: 700; color: #f0f6ff; }

/* ════════════════════════════════════════════════════════════
   TABLET  ≥ 600px
   ════════════════════════════════════════════════════════════ */
@media (min-width: 600px) {

  h1 { font-size: 18px; padding: 15px 22px 14px; }

  .card                   { margin: 10px 20px; padding: 18px 22px; }
  .tab-bar                { margin: 10px 20px 8px; }
  .subject-summary-card   { margin: 0 20px 10px; }
  #editorContainer,
  #qbankContainer         { padding: 0 20px 8px; }

  /* 4-col phase on tablet */
  .phase-grid              { grid-template-columns: 1fr 1fr 1fr 1fr; gap: 10px; }
  .phase-pct               { font-size: 20px; }

}

/* ════════════════════════════════════════════════════════════
   DESKTOP  ≥ 860px
   ════════════════════════════════════════════════════════════ */
@media (min-width: 860px) {

  /* Subtle bg depth for desktop only */
  body {
    background-image:
      radial-gradient(ellipse at 15% 10%, rgba(59,130,246,0.05) 0%, transparent 55%),
      radial-gradient(ellipse at 85% 90%, rgba(139,92,246,0.04) 0%, transparent 55%);
  }

  h1 { font-size: 19px; padding: 16px 28px 15px; }

  .card                    { margin: 12px 28px; padding: 20px 24px; border-radius: 18px; }
  .tab-bar                 { margin: 12px 28px 10px; }
  .subject-summary-card    { margin: 0 28px 12px; }
  #editorContainer,
  #qbankContainer          { padding: 0 28px 10px; }

  /* 4-col analytics on desktop */
  .analytics-grid          { grid-template-columns: repeat(4, minmax(0, 160px)); justify-content: center; gap: 12px; }
  .stat-big                { font-size: 26px; }
  .stat-box                { padding: 16px 12px; }

  /* Phase: always 4 cols on desktop */
  .phase-grid              { grid-template-columns: 1fr 1fr 1fr 1fr; }
  .phase-item              { padding: 14px 10px; }
  .phase-pct               { font-size: 22px; }

  /* Cards slightly elevated on hover on desktop */
  .card:hover {
    box-shadow: 0 6px 32px rgba(0,0,0,0.5);
    border-color: var(--border-lt);
  }
}

/* ════════════════════════════════════════════════════════════
   PHYSICAL LANDSCAPE on mobile  (phone rotated sideways)
   ════════════════════════════════════════════════════════════ */
@media (orientation: landscape) and (max-height: 500px) {
  /* Reduce sticky header height so more content shows */
  h1 { padding: 8px 14px 7px; font-size: 14px; position: sticky; top: 0; z-index: 90; }

  /* Cards tighter vertically */
  .card { padding: 12px 14px; margin: 6px 10px; }

  /* Give the content area full scroll freedom */
  html, body {
    height: auto;
    min-height: 100%;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }

  /* Nav toggle button: respect left notch/safe-area in landscape */
  #nav-toggle-btn {
    top: max(12px, env(safe-area-inset-top, 12px));
    left: env(safe-area-inset-left, 0px);
    border-left: none;
  }
  #nav-toggle-btn.open {
    left: calc(var(--nav-w) + env(safe-area-inset-left, 0px));
  }

  /* Side nav drawer: account for left safe-area so it isn't hidden behind notch */
  .side-nav {
    left: env(safe-area-inset-left, 0px);
    padding-left: 0;
  }

  /* Nav labels: hide in collapsed/icon state but ALWAYS show when drawer is open */
  .side-nav-label { display: none; }
  .side-nav.open .side-nav-label { display: block; }

  /* Brand text must stay visible when drawer is open */
  .side-nav.open .side-nav-brand-text { display: block; opacity: 1; color: #f0f6ff; }

  /* Smaller pills and buttons to fit landscape row */
  .pill { font-size: 9px; padding: 3px 5px; }
  button { min-height: 36px; }
}

/* ════════════════════════════════════════════════════════════
   SMALL PHONES  < 380px
   ════════════════════════════════════════════════════════════ */
@media (max-width: 380px) {

  h1 { font-size: 14px; padding: 12px 12px 11px; }

  .card                   { margin: 8px 8px; padding: 13px 13px; border-radius: 12px; }
  .tab-bar                { margin: 8px 8px 6px; }
  .tab-btn                { font-size: 12px; padding: 8px 6px; min-height: 38px; }
  .subject-summary-card   { margin: 0 8px 8px; }
  #editorContainer,
  #qbankContainer         { padding: 0 8px 6px; }

  .phase-grid             { grid-template-columns: 1fr 1fr; gap: 6px; }
  .phase-pct              { font-size: 18px; }

  .analytics-grid         { grid-template-columns: 1fr 1fr; }

  button   { min-height: 40px; font-size: 13px; padding: 9px 12px; }
  input, select { min-height: 40px; font-size: 13px; padding: 9px 10px; }

  .pill    { font-size: 10px; padding: 4px 6px; }

  /* Very small: tighter rev-bar labels */
  .rev-bar-label { font-size: 9px; width: 16px; }

  /* Shrink add-chapter page inputs so they don't overflow */
  input[id^="addChS-"], input[id^="addChE-"] { width: 52px !important; }

  /* Smaller reorder + pencil buttons */
  .reorder-btn    { font-size: 10px; padding: 3px 5px; min-height: 28px; }
  .edit-name-btn  { font-size: 10px; }
  .size-badge     { font-size: 8px; padding: 1px 5px; }

}

/* ─── Topic Chips ──────────────────────────────────────────── */
.topic-chip {
  display: inline-flex;
  align-items: center;
  padding: 5px 12px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 500;
  cursor: pointer;
  background: #1e293b;
  color: #94a3b8;
  border: 1px solid #334155;
  transition: all 0.15s ease;
  white-space: nowrap;
  user-select: none;
  -webkit-user-select: none;
}
.topic-chip:hover { border-color: #3b82f6; color: #93c5fd; }
.topic-chip.selected {
  background: #1e3a5f !important;
  color: #93c5fd !important;
  border-color: #3b82f6 !important;
}
.topic-chip.already-done {
  background: #1a3a1a;
  color: #4ade80;
  border-color: #166534;
}
.topic-chip.already-done.selected {
  background: #15532e !important;
  border-color: #22c55e !important;
}

/* ─── Form Section ─────────────────────────────────────────── */
.form-section {
  background: #0f172a;
  border-radius: 12px;
  padding: 14px;
  margin-bottom: 10px;
  border: 1px solid #1e293b;
}
.form-section-title {
  font-weight: 700;
  font-size: 13px;
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  gap: 6px;
  color: #e2e8f0;
}

/* ═══════════════════════════════════════════════════════════
   NAV BADGE (Cards due count)
   ═══════════════════════════════════════════════════════════ */
.nav-badge {
  position: absolute;
  top: 4px;
  right: 6px;
  background: var(--red);
  color: #fff;
  font-size: 9px;
  font-weight: 800;
  border-radius: 10px;
  padding: 1px 4px;
  min-width: 15px;
  text-align: center;
  pointer-events: none;
  line-height: 1.4;
}

/* ═══════════════════════════════════════════════════════════
   FLASHCARDS PAGE
   ═══════════════════════════════════════════════════════════ */

/* ── Tab bar ── */
.fc-tabs {
  display: flex;
  border-bottom: 1px solid var(--border);
  background: var(--surface);
  position: sticky;
  top: 54px; /* sits below the sticky h1 */
  z-index: 80;
}
.fc-tab {
  flex: 1;
  padding: 13px 0;
  text-align: center;
  font-size: 13px;
  font-weight: 600;
  color: var(--text-muted);
  cursor: pointer;
  border-bottom: 2px solid transparent;
  transition: color 0.2s, border-color 0.2s;
  user-select: none;
}
.fc-tab.active {
  color: var(--blue);
  border-bottom-color: var(--blue);
}
.fc-panel {
  display: none;
  padding: 14px;
  padding-bottom: 40px;
}
.fc-panel.active { display: block; }

/* ── Review card flip ── */
.fc-review-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
  font-size: 13px;
  color: var(--text-muted);
  font-variant-numeric: tabular-nums;
}
.fc-card-wrapper {
  perspective: 1200px;
  min-height: 220px;
  margin-bottom: 14px;
  cursor: pointer;
}
.fc-card {
  width: 100%;
  min-height: 220px;
  position: relative;
  transform-style: preserve-3d;
  transition: transform 0.42s cubic-bezier(0.4, 0, 0.2, 1);
  border-radius: var(--radius-lg);
}
.fc-card.flipped { transform: rotateY(180deg); }
.fc-face {
  position: absolute;
  width: 100%;
  min-height: 220px;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  border-radius: var(--radius-lg);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 22px 18px;
  box-sizing: border-box;
  background: var(--card);
  border: 1px solid var(--border-lt);
  box-shadow: var(--shadow);
}
.fc-face.fc-back {
  transform: rotateY(180deg);
  background: #0d1e35;
}
.fc-face-text {
  font-size: 17px;
  font-weight: 500;
  text-align: center;
  color: var(--text);
  line-height: 1.5;
}
.fc-face-img {
  max-width: 100%;
  max-height: 140px;
  object-fit: contain;
  border-radius: var(--radius-sm);
  margin-top: 10px;
}
.fc-tap-hint {
  margin-top: 10px;
  font-size: 11px;
  color: var(--text-dim);
}

/* ── Progress bar ── */
.fc-progress-bar {
  width: 100%;
  height: 5px;
  background: rgba(255,255,255,0.06);
  border-radius: 3px;
  overflow: hidden;
  margin-bottom: 6px;
}
.fc-progress-fill {
  height: 100%;
  background: var(--blue);
  transition: width 0.3s ease;
  width: 0%;
}
.fc-progress-label {
  font-size: 11px;
  color: var(--text-dim);
  text-align: right;
  margin-bottom: 14px;
}

/* ── Rating buttons ── */
.fc-rating-buttons {
  display: none;
  grid-template-columns: repeat(4, 1fr);
  gap: 8px;
}
.fc-rating-buttons.visible { display: grid; }
.fc-rating-btn {
  padding: 11px 0;
  border: none;
  border-radius: var(--radius);
  font-size: 12px;
  font-weight: 700;
  cursor: pointer;
  transition: opacity 0.15s, transform 0.1s;
  min-height: 44px;
  margin-top: 0;
}
.fc-rating-btn:active { transform: scale(0.95); }
.fc-rating-btn[data-r="1"] { background: rgba(239,68,68,0.18);  color: #fca5a5; }
.fc-rating-btn[data-r="2"] { background: rgba(245,158,11,0.18); color: #fcd34d; }
.fc-rating-btn[data-r="3"] { background: rgba(16,185,129,0.18); color: #6ee7b7; }
.fc-rating-btn[data-r="4"] { background: rgba(59,130,246,0.18); color: #93c5fd; }

/* ── Start / empty / complete screens ── */
.fc-screen {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 52px 20px;
  text-align: center;
  gap: 10px;
}
.fc-big-icon  { font-size: 52px; }
.fc-big-count { font-size: 32px; font-weight: 900; color: var(--text); letter-spacing: -0.02em; }
.fc-sub-text  { font-size: 13px; color: var(--text-muted); }

/* ── Session summary grid ── */
.fc-summary-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  margin: 14px 0;
  width: 100%;
  max-width: 320px;
}
.fc-summary-cell {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 13px;
  text-align: center;
}
.fc-sc-val   { font-size: 26px; font-weight: 800; letter-spacing: -0.02em; }
.fc-sc-label { font-size: 11px; color: var(--text-muted); margin-top: 2px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }
.fc-summary-cell.s-again .fc-sc-val { color: var(--red);    }
.fc-summary-cell.s-hard  .fc-sc-val { color: var(--yellow); }
.fc-summary-cell.s-good  .fc-sc-val { color: var(--green);  }
.fc-summary-cell.s-easy  .fc-sc-val { color: var(--blue);   }

/* ── Browse tab ── */
.fc-filters {
  display: flex;
  flex-wrap: wrap;
  gap: 7px;
  margin-bottom: 10px;
}
.fc-filter-select {
  flex: 1 1 130px;
  min-height: 38px;
  padding: 7px 10px;
  font-size: 12px;
  margin: 0;
}
.fc-search {
  width: 100%;
  margin-bottom: 10px;
  min-height: 40px;
  font-size: 13px;
}
.fc-card-list { display: flex; flex-direction: column; gap: 8px; }
.fc-browse-item {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 12px 14px;
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 10px;
}
.fc-bi-content { flex: 1; min-width: 0; }
.fc-bi-front {
  font-size: 13px;
  font-weight: 500;
  color: var(--text);
  margin-bottom: 3px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.fc-bi-meta { font-size: 11px; color: var(--text-muted); }
.fc-bi-actions { display: flex; gap: 5px; flex-shrink: 0; }
.fc-icon-btn {
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  cursor: pointer;
  transition: border-color 0.15s;
  margin: 0;
  min-height: unset;
  padding: 0;
  color: var(--text-muted);
}
.fc-icon-btn:hover { border-color: var(--blue); color: var(--blue); box-shadow: none; }

/* ── Create tab ── */
.fc-type-toggle { display: flex; gap: 7px; margin-bottom: 14px; }
.fc-type-btn {
  flex: 1;
  padding: 9px 0;
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  font-size: 12px;
  font-weight: 700;
  background: var(--card);
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.15s;
  text-align: center;
  margin: 0;
  min-height: 38px;
}
.fc-type-btn.active {
  background: var(--blue);
  color: #fff;
  border-color: var(--blue);
}
.fc-form-group { margin-bottom: 13px; }
.fc-form-label {
  display: block;
  font-size: 11px;
  font-weight: 700;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.07em;
  margin-bottom: 5px;
}
.fc-upload-box {
  border: 1.5px dashed var(--border-lt);
  border-radius: var(--radius);
  padding: 16px;
  text-align: center;
  color: var(--text-dim);
  cursor: pointer;
  font-size: 12px;
  transition: border-color 0.2s;
  margin-top: 6px;
}
.fc-upload-box:hover { border-color: var(--blue); color: var(--blue); }
.fc-img-preview { display: none; position: relative; margin-top: 8px; }
.fc-img-preview img { max-width: 100%; max-height: 140px; object-fit: contain; border-radius: var(--radius-sm); }
.fc-img-remove {
  position: absolute;
  top: 4px; right: 4px;
  background: rgba(0,0,0,0.6);
  color: #fff;
  border: none;
  border-radius: 50%;
  width: 22px; height: 22px;
  cursor: pointer;
  font-size: 12px;
  display: flex; align-items: center; justify-content: center;
  padding: 0; margin: 0; min-height: unset;
}
.fc-upload-progress { display: none; font-size: 11px; color: var(--blue); margin-top: 4px; }
.fc-link-selectors { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 7px; }
.fc-link-selectors select { margin: 0; min-height: 38px; font-size: 12px; }
.fc-tag-wrap {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 7px;
  min-height: 40px;
  align-items: center;
  background: var(--bg);
  cursor: text;
}
.fc-tag-chip {
  background: rgba(59,130,246,0.15);
  color: var(--blue);
  border-radius: 20px;
  padding: 2px 9px;
  font-size: 11px;
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 4px;
}
.fc-tag-chip-x { cursor: pointer; color: var(--text-dim); font-size: 12px; }
.fc-tag-text-input {
  border: none;
  outline: none;
  font-size: 12px;
  min-width: 70px;
  background: transparent;
  color: var(--text);
  font-family: inherit;
  width: auto;
  min-height: unset;
  padding: 0;
  margin: 0;
}
.fc-btn-row { display: flex; gap: 8px; margin-top: 6px; }
.fc-btn-primary {
  background: var(--blue);
  color: #fff;
  border: none;
  border-radius: var(--radius);
  padding: 12px 20px;
  font-size: 14px;
  font-weight: 700;
  cursor: pointer;
  flex: 1;
  margin: 0;
  min-height: 44px;
}
.fc-btn-secondary {
  background: var(--card);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 12px 16px;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  margin: 0;
  min-height: 44px;
}
.fc-status { font-size: 12px; color: var(--blue); margin-top: 8px; min-height: 16px; }
.fc-cloze-hint {
  background: rgba(59,130,246,0.08);
  border: 1px solid rgba(59,130,246,0.2);
  border-radius: var(--radius-sm);
  padding: 9px 12px;
  font-size: 12px;
  color: var(--text-muted);
  margin-top: 6px;
}

/* ── AI Generate modal ── */
.fc-modal-backdrop {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  z-index: 300;
  align-items: flex-end;
  justify-content: center;
}
.fc-modal-backdrop.open { display: flex; }
.fc-modal-sheet {
  background: var(--surface);
  border-radius: 20px 20px 0 0;
  padding: 22px;
  width: 100%;
  max-width: 600px;
  max-height: 82vh;
  overflow-y: auto;
  box-sizing: border-box;
  border-top: 1px solid var(--border-lt);
}
.fc-modal-title { font-size: 16px; font-weight: 800; margin-bottom: 10px; color: var(--text); }
.fc-ai-preview-list { display: flex; flex-direction: column; gap: 8px; margin: 10px 0; max-height: 280px; overflow-y: auto; }
.fc-ai-card {
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 11px 13px;
  background: var(--card);
}
.fc-ai-card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 5px;
  font-size: 11px;
  font-weight: 700;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}
.fc-ai-card textarea {
  width: 100%;
  border: none;
  background: transparent;
  resize: none;
  font-size: 12px;
  font-family: inherit;
  color: var(--text);
  outline: none;
  min-height: unset;
  padding: 0;
  margin: 0;
}

/* ═══════════════════════════════════════════════════════════
   NOTES — DRILL-DOWN CARD LAYOUT
   ═══════════════════════════════════════════════════════════ */

/* Page wrapper */
.notes-page { padding: 0 0 40px; }

/* Breadcrumb bar */
.notes-breadcrumb-bar {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 16px;
  border-bottom: 1px solid var(--border);
  background: var(--surface);
  position: sticky;
  top: 0;
  z-index: 50;
  flex-wrap: wrap;
}
.notes-bc-back {
  display: flex;
  align-items: center;
  gap: 5px;
  background: var(--card);
  border: 1px solid var(--border);
  color: var(--text-muted);
  padding: 5px 12px;
  border-radius: var(--radius-sm);
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  margin: 0;
  min-height: unset;
  transition: color 0.15s, border-color 0.15s;
}
.notes-bc-back:hover { color: var(--text); border-color: var(--border-lt); opacity: 1; box-shadow: none; }
.notes-bc-path {
  font-size: 12px;
  color: var(--text-muted);
  display: flex;
  align-items: center;
  gap: 5px;
  flex: 1;
  min-width: 0;
  overflow-x: auto;
  white-space: nowrap;
  scrollbar-width: none;
  -ms-overflow-style: none;
}
.notes-bc-path::-webkit-scrollbar { display: none; }
.notes-bc-sep { color: var(--text-dim); }
.notes-bc-crumb { color: var(--text-muted); }
.notes-bc-crumb.current { color: var(--text); font-weight: 600; }

/* Search bar */
.notes-search-bar {
  padding: 12px 16px 8px;
}
.notes-search-bar input {
  width: 100%;
  font-size: 13px;
  padding: 10px 14px;
  border-radius: var(--radius);
  margin: 0;
  min-height: unset;
}

/* Progress bar */
.notes-progress-bar {
  margin: 0 16px 12px;
  display: flex;
  align-items: center;
  gap: 10px;
}
.notes-progress-label {
  font-size: 11px;
  font-weight: 700;
  color: var(--text-muted);
  white-space: nowrap;
}
.notes-progress-track {
  flex: 1;
  height: 5px;
  background: rgba(255,255,255,0.06);
  border-radius: 20px;
  overflow: hidden;
}
.notes-progress-fill {
  height: 100%;
  background: var(--blue);
  border-radius: 20px;
  transition: width 0.6s cubic-bezier(.34,1.56,.64,1);
}
.notes-progress-pct {
  font-size: 11px;
  font-weight: 800;
  color: var(--blue);
  white-space: nowrap;
}

/* Grid containers */
.notes-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 12px;
  padding: 8px 16px 20px;
}

/* Subject card */
.notes-subj-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 20px 16px 16px;
  cursor: pointer;
  transition: border-color 0.2s, transform 0.15s, box-shadow 0.2s;
  display: flex;
  flex-direction: column;
  gap: 8px;
  min-height: 140px;
  position: relative;
  overflow: hidden;
}
.notes-subj-card:hover {
  border-color: var(--border-lt);
  transform: translateY(-2px);
  box-shadow: var(--shadow);
}
.notes-subj-card-accent {
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 3px;
  border-radius: var(--radius-lg) var(--radius-lg) 0 0;
}
.notes-subj-card-name {
  font-size: 15px;
  font-weight: 800;
  color: #f0f6ff;
  line-height: 1.3;
  margin-top: 4px;
}
.notes-subj-card-meta {
  margin-top: auto;
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.notes-subj-card-badge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  background: rgba(255,255,255,0.06);
  border-radius: 20px;
  padding: 3px 9px;
  font-size: 11px;
  color: var(--text-muted);
  font-weight: 600;
}

/* Unit card */
.notes-unit-grid-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 16px;
  cursor: pointer;
  transition: border-color 0.2s, transform 0.15s, box-shadow 0.2s;
  display: flex;
  flex-direction: column;
  gap: 6px;
  min-height: 110px;
  position: relative;
  overflow: hidden;
}
.notes-unit-grid-card:hover {
  border-color: var(--border-lt);
  transform: translateY(-1px);
  box-shadow: var(--shadow-sm);
}
.notes-unit-grid-card-name {
  font-size: 13px;
  font-weight: 700;
  color: var(--text);
  line-height: 1.4;
}
.notes-unit-grid-card-badge {
  margin-top: auto;
  font-size: 11px;
  color: var(--text-muted);
}
.notes-unit-arrow {
  position: absolute;
  bottom: 12px; right: 12px;
  font-size: 14px;
  color: var(--text-dim);
}
.notes-unit-bytype-btn {
  align-self: flex-start;
  margin-top: auto;
  font-size: 10px;
  padding: 3px 8px;
  border-radius: var(--radius-sm);
  background: rgba(59,130,246,0.1);
  color: var(--blue);
  border: 1px solid rgba(59,130,246,0.25);
  cursor: pointer;
  font-weight: 600;
  min-height: unset;
  line-height: 1.4;
  transition: background 0.15s;
}
.notes-unit-bytype-btn:hover {
  background: rgba(59,130,246,0.2);
}

/* Chapter card */
.notes-chap-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 14px;
  cursor: pointer;
  transition: border-color 0.2s, background 0.15s;
  display: flex;
  align-items: center;
  gap: 10px;
  min-height: 56px;
}
.notes-chap-card:hover { border-color: var(--border-lt); background: rgba(255,255,255,0.02); }
.notes-chap-card.has-note { border-color: rgba(59,130,246,0.2); }
.notes-chap-icon { font-size: 18px; flex-shrink: 0; }
.notes-chap-name { font-size: 13px; font-weight: 600; color: var(--text); flex: 1; line-height: 1.4; }
.notes-chap-meta { font-size: 10px; color: var(--text-dim); margin-top: 2px; }
.notes-chap-status {
  display: inline-flex;
  align-items: center;
  gap: 3px;
  font-size: 9px;
  font-weight: 700;
  padding: 2px 6px;
  border-radius: 20px;
  white-space: nowrap;
  flex-shrink: 0;
}
.notes-chap-status.ns  { background: rgba(100,116,139,0.15); color: var(--text-dim); }
.notes-chap-status.cp  { background: rgba(16,185,129,0.12);  color: #10b981; }
.notes-chap-status.rv  { background: rgba(245,158,11,0.12);  color: #f59e0b; }
.notes-chap-right { display: flex; flex-direction: column; align-items: flex-end; gap: 3px; flex-shrink: 0; }

/* Color dot */
.note-color-dot {
  width: 10px; height: 10px;
  border-radius: 50%;
  flex-shrink: 0;
  transition: box-shadow 0.2s;
}
.note-color-dot.default { background: var(--text-dim); }
.note-color-dot.red    { background: var(--red);    box-shadow: 0 0 6px rgba(239,68,68,0.55);  }
.note-color-dot.yellow { background: var(--yellow); box-shadow: 0 0 6px rgba(245,158,11,0.55); }
.note-color-dot.green  { background: var(--green);  box-shadow: 0 0 6px rgba(16,185,129,0.55); }
.note-color-dot.blue   { background: var(--blue);   box-shadow: 0 0 6px rgba(59,130,246,0.55);  }

/* Section heading */
.notes-section-head {
  font-size: 10px;
  font-weight: 800;
  color: var(--text-dim);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  padding: 8px 16px 4px;
}

/* ── Note read/edit view ── */
.notes-note-view {
  padding: 0;
  display: flex;
  flex-direction: column;
  min-height: calc(100vh - 52px);
}
.notes-note-topbar {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 14px;
  border-bottom: 1px solid var(--border);
  background: var(--surface);
  flex-wrap: wrap;
  position: sticky;
  top: 0;
  z-index: 40;
}
.notes-note-topbar-title {
  font-size: 15px;
  font-weight: 800;
  color: #f0f6ff;
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.notes-edit-btn {
  background: var(--card);
  border: 1px solid var(--border);
  color: var(--text-muted);
  font-size: 12px;
  padding: 5px 12px;
  border-radius: var(--radius-sm);
  cursor: pointer;
  margin: 0;
  min-height: unset;
  font-weight: 600;
  transition: color 0.15s, border-color 0.15s;
}
.notes-edit-btn:hover { color: var(--blue); border-color: rgba(59,130,246,0.4); opacity: 1; box-shadow: none; }
.notes-edit-btn.active { background: rgba(59,130,246,0.12); color: var(--blue); border-color: rgba(59,130,246,0.4); }

/* Font picker in note topbar */
.note-font-select {
  background: var(--card);
  border: 1px solid var(--border);
  color: var(--text-muted);
  font-size: 11px;
  font-weight: 600;
  padding: 4px 8px;
  border-radius: var(--radius-sm);
  cursor: pointer;
  min-height: unset;
  margin: 0;
  flex-shrink: 0;
  outline: none;
  appearance: auto;
}
.note-font-select:focus { border-color: rgba(59,130,246,0.4); color: var(--text); }
.note-font-select option { background: #1e293b; color: var(--text); }

/* Read view: rendered markdown */
.notes-read-body {
  flex: 1;
  padding: 20px 20px 60px;
  font-size: 14px;
  line-height: 1.8;
  color: var(--text);
  overflow-y: auto;
  max-width: 720px;
  margin: 0 auto;
  width: 100%;
  box-sizing: border-box;
}
.notes-read-body img { max-width: 100%; border-radius: var(--radius-sm); margin: 8px 0; }
.notes-read-body table { width: 100%; border-collapse: collapse; font-size: 13px; margin: 10px 0; }
.notes-read-body th, .notes-read-body td { border: 1px solid var(--border); padding: 6px 10px; text-align: left; }
.notes-read-body th { background: var(--card); font-weight: 700; }
.notes-read-body h1, .notes-read-body h2, .notes-read-body h3 { color: #f0f6ff; margin: 16px 0 8px; }
.notes-read-body h2 { font-size: 15px; }
.notes-read-body h3 { font-size: 13px; }
.notes-read-body code { background: var(--card); padding: 2px 5px; border-radius: 4px; font-size: 12px; }
.notes-read-body pre  { background: var(--card); padding: 12px; border-radius: var(--radius-sm); overflow-x: auto; }
.notes-read-body strong { color: #f0f6ff; }
.notes-read-body ul, .notes-read-body ol { padding-left: 20px; margin: 6px 0; }
.notes-read-body blockquote { border-left: 3px solid var(--blue); padding-left: 12px; color: var(--text-muted); margin: 8px 0; }

/* Edit view: full editor */
.notes-edit-wrap {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}
.notes-editor-toolbar {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 14px 8px;
  border-bottom: 1px solid var(--border);
  background: var(--surface);
  flex-wrap: wrap;
  row-gap: 8px;
}
.notes-editor-toolbar input[type="text"] {
  width: 100%;
  flex-shrink: 0;
  font-size: 14px;
  font-weight: 600;
  background: transparent;
  border: none;
  border-bottom: 1px solid var(--border);
  color: var(--text);
  padding: 4px 2px 8px;
  min-height: unset;
  margin: 0;
}
.notes-editor-toolbar input[type="text"]:focus { box-shadow: none; border-bottom: 1px solid var(--blue); border-radius: 0; }
.note-color-picker { display: flex; gap: 5px; }
.note-color-swatch {
  width: 18px; height: 18px;
  border-radius: 50%;
  cursor: pointer;
  border: 2px solid transparent;
  transition: border-color 0.15s, transform 0.1s;
  flex-shrink: 0;
}
.note-color-swatch:hover  { transform: scale(1.2); }
.note-color-swatch.active { border-color: var(--text); }
.note-color-swatch.sw-default { background: var(--text-dim); }
.note-color-swatch.sw-red    { background: var(--red);    }
.note-color-swatch.sw-yellow { background: var(--yellow); }
.note-color-swatch.sw-green  { background: var(--green);  }
.note-color-swatch.sw-blue   { background: var(--blue);   }

.notes-editor-area {
  flex: 1;
  display: flex;
  overflow: hidden;
}
.notes-md-editor {
  flex: 1;
  width: 100%;
  background: var(--bg);
  color: var(--text);
  border: none;
  padding: 16px;
  font-size: 14px;
  font-family: 'SF Mono', 'Fira Code', monospace;
  resize: none;
  line-height: 1.7;
  box-sizing: border-box;
  min-height: unset;
  margin: 0;
}
.notes-md-editor:focus { outline: none; box-shadow: none; border: none; }

.notes-editor-footer {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 14px;
  border-top: 1px solid var(--border);
  background: var(--surface);
  flex-wrap: wrap;
}
.notes-tag-wrap {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
  flex: 1;
  align-items: center;
  min-height: 30px;
}
.notes-tag-chip {
  background: rgba(59,130,246,0.15);
  color: var(--blue);
  border-radius: 20px;
  padding: 2px 9px;
  font-size: 11px;
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 4px;
}
.notes-tag-chip-x { cursor: pointer; color: var(--text-dim); font-size: 11px; }
.notes-tag-input {
  border: none;
  background: transparent;
  color: var(--text);
  font-size: 11px;
  min-width: 60px;
  outline: none;
  font-family: inherit;
  padding: 0; margin: 0; min-height: unset; width: auto;
}

/* Empty / placeholder */
.notes-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 10px;
  color: var(--text-muted);
  text-align: center;
  padding: 60px 20px;
}
.notes-empty-icon  { font-size: 44px; }
.notes-empty-text  { font-size: 14px; }
.notes-empty-sub   { font-size: 12px; color: var(--text-dim); }

/* Search results list */
.notes-search-results { padding: 0 16px; }
.notes-search-result-item {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 12px 14px;
  margin-bottom: 8px;
  cursor: pointer;
  transition: border-color 0.2s;
}
.notes-search-result-item:hover { border-color: var(--border-lt); }
.notes-search-result-title { font-size: 13px; font-weight: 700; color: var(--text); }
.notes-search-result-path  { font-size: 10px; color: var(--text-muted); margin-top: 2px; }
.notes-search-result-preview { font-size: 11px; color: var(--text-dim); margin-top: 4px; }

/* Unit stacked view */
.notes-unit-view { padding: 14px; }
.notes-unit-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 14px 16px;
  margin-bottom: 10px;
  cursor: pointer;
  transition: border-color 0.2s;
}
.notes-unit-card:hover { border-color: var(--border-lt); }
.notes-unit-card-header { display: flex; align-items: center; gap: 8px; margin-bottom: 6px; }
.notes-collapse-btn {
  flex-shrink: 0;
  background: transparent;
  border: 1px solid var(--border);
  color: var(--text-dim);
  border-radius: 6px;
  padding: 2px 7px;
  font-size: 13px;
  line-height: 1;
  cursor: pointer;
  min-height: unset;
  margin: 0;
  transition: background 0.15s, color 0.15s;
}
.notes-collapse-btn:hover { background: var(--card-hover, rgba(255,255,255,0.06)); color: var(--text); }
.notes-unit-card-title { font-size: 13px; font-weight: 700; color: var(--text); }
.notes-unit-card-preview { font-size: 12px; color: var(--text-muted); line-height: 1.5; }
.notes-unit-card-img { max-width: 100%; max-height: 100px; object-fit: cover; border-radius: var(--radius-sm); margin-top: 8px; }

/* ═══════════════════════════════════════════════════════════
   FLASHCARDS BROWSE — ACCORDION LAYOUT
   ═══════════════════════════════════════════════════════════ */

/* New / Revise sub-tabs */
.fc-browse-subtabs {
  display: flex;
  gap: 4px;
  padding: 12px 16px 8px;
}
.fc-browse-subtab {
  flex: 1;
  background: var(--card);
  border: 1px solid var(--border);
  color: var(--text-muted);
  border-radius: var(--radius-sm);
  padding: 9px 12px;
  font-size: 13px;
  font-weight: 700;
  cursor: pointer;
  text-align: center;
  transition: all 0.2s;
  margin: 0;
  min-height: unset;
}
.fc-browse-subtab.active {
  background: var(--blue);
  color: white;
  border-color: var(--blue);
  box-shadow: 0 2px 12px rgba(59,130,246,0.3);
}
.fc-browse-subtab:hover:not(.active) { color: var(--text); border-color: var(--border-lt); opacity: 1; box-shadow: none; }

/* Search + filter row */
.fc-browse-search-row {
  display: flex;
  gap: 8px;
  padding: 0 16px 8px;
  align-items: center;
}
.fc-browse-search-row input {
  flex: 1;
  margin: 0;
  min-height: 38px;
  font-size: 13px;
  padding: 8px 12px;
}

/* Subject accordion */
.fc-acc-subject {
  margin: 0 0 2px;
  border-left: 3px solid transparent;
  transition: border-color 0.15s;
}
.fc-acc-subject.open { border-left-color: var(--blue); }

.fc-acc-subject-head {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 12px 16px;
  cursor: pointer;
  background: var(--surface);
  border-bottom: 1px solid var(--border);
  transition: background 0.15s;
  user-select: none;
}
.fc-acc-subject-head:hover { background: rgba(255,255,255,0.03); }
.fc-acc-subject-name {
  font-size: 14px;
  font-weight: 800;
  color: var(--text);
  flex: 1;
}
.fc-acc-subject-count {
  background: var(--card);
  color: var(--text-muted);
  font-size: 11px;
  font-weight: 700;
  padding: 2px 8px;
  border-radius: 20px;
  border: 1px solid var(--border);
}
.fc-acc-subject-count.has-due {
  background: rgba(239,68,68,0.15);
  color: var(--red);
  border-color: rgba(239,68,68,0.3);
}
.fc-acc-chevron {
  font-size: 11px;
  color: var(--text-dim);
  transition: transform 0.2s;
}
.fc-acc-subject.open .fc-acc-chevron { transform: rotate(180deg); }

.fc-acc-learn-btn {
  background: transparent;
  border: 1px solid var(--border);
  color: var(--blue);
  font-size: 11px;
  font-weight: 700;
  padding: 4px 10px;
  border-radius: var(--radius-sm);
  cursor: pointer;
  margin: 0;
  min-height: unset;
  white-space: nowrap;
  transition: background 0.15s, border-color 0.15s;
}
.fc-acc-learn-btn:hover { background: rgba(59,130,246,0.1); border-color: rgba(59,130,246,0.4); opacity: 1; box-shadow: none; }
.fc-acc-learn-btn.revise { color: var(--green); }
.fc-acc-learn-btn.revise:hover { background: rgba(16,185,129,0.1); border-color: rgba(16,185,129,0.4); }

/* Unit rows */
.fc-acc-units { display: none; }
.fc-acc-subject.open .fc-acc-units { display: block; }

.fc-acc-unit {
  border-bottom: 1px solid var(--border);
}
.fc-acc-unit-head {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 9px 10px 9px 14px;
  cursor: pointer;
  background: rgba(255,255,255,0.01);
  transition: background 0.15s;
  user-select: none;
}
.fc-acc-unit-head:hover { background: rgba(255,255,255,0.03); }
.fc-acc-unit-name {
  font-size: 13px;
  font-weight: 600;
  color: var(--text-muted);
  flex: 1;
}
.fc-acc-unit.open .fc-acc-unit-name { color: var(--text); }

/* Chapter rows */
.fc-acc-chapters { display: none; }
.fc-acc-unit.open .fc-acc-chapters { display: block; }

/* fc-acc-chapter is now a block container — head + cards stack vertically */
.fc-acc-chapter {
  display: block;
  border-bottom: 1px solid rgba(30,51,80,0.5);
  background: rgba(255,255,255,0.005);
}
.fc-acc-chapter-name {
  font-size: 12px;
  color: var(--text-dim);
  flex: 1;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.fc-acc-chapter-count {
  font-size: 10px;
  color: var(--text-dim);
  white-space: nowrap;
}

/* Browse empty/loading */
.fc-browse-loading {
  text-align: center;
  padding: 40px 16px;
  font-size: 13px;
  color: var(--text-muted);
}

/* Responsive adjustments */
@media (max-width: 640px) {
  .notes-grid { grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 8px; padding: 8px 10px; }
}

/* ═══════════════════════════════════════════════════════════
   NEW FEATURES — Bulk Delete, CSV Import, Card Stats, Quick Add,
   Streak, Edit-in-Review, Note→Card Bridge, Keyboard Hints
   ═══════════════════════════════════════════════════════════ */

/* ── Browse: Select mode / bulk delete ───────────────────── */
.browse-bulk-bar {
  position: fixed;
  bottom: 0; left: 0; right: 0;
  background: rgba(10,18,36,0.97);
  backdrop-filter: blur(16px);
  border-top: 1px solid var(--border);
  padding: 12px 16px;
  display: flex;
  align-items: center;
  gap: 10px;
  z-index: 150;
  transform: translateY(100%);
  transition: transform 0.25s cubic-bezier(.4,0,.2,1);
}
.browse-bulk-bar.visible { transform: translateY(0); }
@media (max-width: 640px) { .browse-bulk-bar { left: 0; } }

.browse-bulk-count {
  font-size: 13px;
  font-weight: 700;
  color: var(--text);
  flex: 1;
}
.browse-bulk-delete {
  background: var(--red);
  color: #fff;
  border: none;
  padding: 9px 18px;
  border-radius: var(--radius-sm);
  font-size: 13px;
  font-weight: 700;
  cursor: pointer;
  margin: 0;
  min-height: unset;
}
.browse-bulk-cancel {
  background: var(--card);
  color: var(--text-muted);
  border: 1px solid var(--border);
  padding: 9px 14px;
  border-radius: var(--radius-sm);
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  margin: 0;
  min-height: unset;
}

/* Browse select mode checkbox */
.browse-select-cb {
  width: 18px; height: 18px;
  flex-shrink: 0;
  accent-color: var(--blue);
  cursor: pointer;
  margin: 0;
  min-height: unset;
}

/* Section delete button (3-dot menu) */
.fc-acc-section-menu {
  position: relative;
  display: inline-flex;
}
.fc-acc-menu-btn {
  background: transparent;
  border: 1px solid transparent;
  color: var(--text-dim);
  font-size: 13px;
  padding: 3px 6px;
  border-radius: 6px;
  cursor: pointer;
  margin: 0;
  min-height: unset;
  line-height: 1;
  transition: background 0.15s, border-color 0.15s;
}
.fc-acc-menu-btn:hover { background: var(--card); border-color: var(--border); color: var(--text-muted); opacity: 1; box-shadow: none; }
.fc-acc-menu-dropdown {
  display: none;
  position: absolute;
  right: 0; top: 100%;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  box-shadow: var(--shadow);
  z-index: 200;
  min-width: 170px;
  overflow: hidden;
}
.fc-acc-menu-dropdown.open { display: block; }
.fc-acc-menu-item {
  display: block;
  padding: 9px 14px;
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
  cursor: pointer;
  white-space: nowrap;
  transition: background 0.1s;
  background: none;
  border: none;
  width: 100%;
  text-align: left;
  margin: 0;
  min-height: unset;
  border-radius: 0;
}
.fc-acc-menu-item:hover { background: rgba(255,255,255,0.05); color: var(--text); opacity: 1; box-shadow: none; }
.fc-acc-menu-item.danger { color: var(--red); }
.fc-acc-menu-item.danger:hover { background: rgba(239,68,68,0.08); }

/* Card row in browse with checkbox */
.fc-card-row {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px 8px 44px;
  border-bottom: 1px solid rgba(30,51,80,0.5);
  background: rgba(255,255,255,0.005);
  transition: background 0.15s;
  position: relative;
}
.fc-card-row:hover { background: rgba(255,255,255,0.025); }
.fc-card-row-front {
  flex: 1;
  font-size: 12px;
  color: var(--text-muted);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.fc-card-row-actions {
  display: flex;
  gap: 4px;
  flex-shrink: 0;
  opacity: 1;
  transition: opacity 0.15s;
}
.fc-card-row:hover .fc-card-row-actions { opacity: 1; }
.fc-card-row-btn {
  background: transparent;
  border: 1px solid var(--border);
  color: var(--text-dim);
  font-size: 11px;
  padding: 3px 7px;
  border-radius: 5px;
  cursor: pointer;
  margin: 0;
  min-height: unset;
  transition: background 0.1s;
}
.fc-card-row-btn:hover { opacity: 1; box-shadow: none; }
.fc-card-row-btn.edit:hover { background: rgba(59,130,246,0.15); border-color: var(--blue); color: var(--blue); }
.fc-card-row-btn.del:hover  { background: rgba(239,68,68,0.15);  border-color: var(--red);  color: var(--red); }

/* Card Stats tooltip on hover */
.fc-card-stats-pill {
  font-size: 10px;
  color: var(--text-dim);
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 20px;
  padding: 2px 8px;
  white-space: nowrap;
  flex-shrink: 0;
}

/* Chapter completion indicator */
.fc-chapter-complete { color: var(--green); font-size: 12px; margin-right: 4px; }

/* Quick Add inline form */
.fc-quick-add-form {
  display: none;
  padding: 10px 16px 10px 44px;
  background: rgba(59,130,246,0.04);
  border-bottom: 1px solid rgba(59,130,246,0.15);
  gap: 8px;
  flex-direction: column;
}
.fc-quick-add-form.open { display: flex; }
.fc-quick-add-row {
  display: flex;
  gap: 8px;
  align-items: flex-start;
}
.fc-quick-add-textarea {
  flex: 1;
  min-height: 56px;
  font-size: 12px;
  resize: none;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  color: var(--text);
  padding: 7px 10px;
  font-family: inherit;
  margin: 0;
  min-height: 44px;
}
.fc-quick-add-textarea:focus { border-color: var(--blue); outline: none; }
.fc-quick-add-type {
  font-size: 11px;
  padding: 5px 8px;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 6px;
  color: var(--text-muted);
  min-height: unset;
  margin: 0;
  flex-shrink: 0;
}
.fc-quick-add-save {
  background: var(--blue);
  color: #fff;
  border: none;
  padding: 7px 14px;
  border-radius: var(--radius-sm);
  font-size: 12px;
  font-weight: 700;
  cursor: pointer;
  margin: 0;
  min-height: unset;
  flex-shrink: 0;
}
.fc-quick-add-cancel {
  background: transparent;
  color: var(--text-dim);
  border: 1px solid var(--border);
  padding: 7px 10px;
  border-radius: var(--radius-sm);
  font-size: 12px;
  cursor: pointer;
  margin: 0;
  min-height: unset;
  flex-shrink: 0;
}
.fc-add-chapter-btn {
  background: transparent;
  border: 1px dashed var(--border);
  color: var(--text-dim);
  font-size: 11px;
  font-weight: 600;
  padding: 5px 10px;
  border-radius: var(--radius-sm);
  cursor: pointer;
  margin: 0;
  min-height: unset;
  transition: border-color 0.15s, color 0.15s;
}
.fc-add-chapter-btn:hover { border-color: var(--blue); color: var(--blue); opacity: 1; box-shadow: none; }

/* ── Review: streak badge + edit/delete in session ────────── */
#review-streak-badge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  background: rgba(245,158,11,0.12);
  border: 1px solid rgba(245,158,11,0.3);
  border-radius: 20px;
  padding: 3px 10px;
  font-size: 12px;
  font-weight: 700;
  color: var(--yellow);
  margin-left: auto;
  transition: all 0.3s;
}
#review-streak-badge.hidden { opacity: 0; pointer-events: none; }

#review-card-actions {
  display: none;
  justify-content: flex-end;
  gap: 8px;
  margin: 6px 0 -4px;
}
#review-card-actions.visible { display: flex; }
.review-card-action-btn {
  background: var(--card);
  border: 1px solid var(--border);
  color: var(--text-muted);
  font-size: 12px;
  padding: 6px 14px;
  border-radius: var(--radius-sm);
  cursor: pointer;
  font-weight: 600;
  margin: 0;
  min-height: unset;
  transition: background 0.15s, border-color 0.15s, color 0.15s;
}
.review-card-action-btn.edit:hover { background: rgba(59,130,246,0.12); border-color: var(--blue); color: var(--blue); opacity: 1; box-shadow: none; }
.review-card-action-btn.del:hover  { background: rgba(239,68,68,0.1);   border-color: var(--red);  color: var(--red); opacity: 1; box-shadow: none; }

/* Keyboard shortcut hint */
#review-kb-hint {
  text-align: center;
  font-size: 11px;
  color: var(--text-dim);
  margin-top: 8px;
}
#review-kb-hint kbd {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 4px;
  padding: 1px 5px;
  font-size: 10px;
  font-family: monospace;
}

/* ── Confirm / Generic Modal ──────────────────────────────── */
.gen-modal-backdrop {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  z-index: 500;
  align-items: center;
  justify-content: center;
  padding: 16px;
}
.gen-modal-backdrop.open { display: flex; }
.gen-modal-box {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 24px;
  max-width: 420px;
  width: 100%;
  box-shadow: var(--shadow);
}
.gen-modal-title {
  font-size: 16px;
  font-weight: 800;
  color: var(--text);
  margin-bottom: 8px;
}
.gen-modal-body {
  font-size: 13px;
  color: var(--text-muted);
  margin-bottom: 18px;
  line-height: 1.55;
}
.gen-modal-btns {
  display: flex;
  gap: 10px;
  justify-content: flex-end;
}
.gen-modal-cancel {
  background: var(--card);
  color: var(--text-muted);
  border: 1px solid var(--border);
  padding: 10px 18px;
  border-radius: var(--radius-sm);
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  margin: 0;
  min-height: unset;
}
.gen-modal-confirm {
  background: var(--red);
  color: #fff;
  border: none;
  padding: 10px 18px;
  border-radius: var(--radius-sm);
  font-size: 13px;
  font-weight: 700;
  cursor: pointer;
  margin: 0;
  min-height: unset;
}
.gen-modal-confirm.safe { background: var(--blue); }

/* Edit card modal in review */
.edit-card-modal-backdrop {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.65);
  z-index: 600;
  align-items: flex-end;
  justify-content: center;
}
.edit-card-modal-backdrop.open { display: flex; }
.edit-card-modal-sheet {
  background: var(--surface);
  border-radius: 20px 20px 0 0;
  border: 1px solid var(--border);
  padding: 20px 20px 28px;
  width: 100%;
  max-width: 620px;
  max-height: 80vh;
  overflow-y: auto;
  box-shadow: var(--shadow);
}
.edit-card-modal-title {
  font-size: 15px;
  font-weight: 800;
  color: var(--text);
  margin-bottom: 14px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.edit-card-modal-close {
  background: transparent;
  border: 1px solid var(--border);
  color: var(--text-dim);
  font-size: 14px;
  padding: 4px 10px;
  border-radius: var(--radius-sm);
  cursor: pointer;
  margin: 0;
  min-height: unset;
}
.ecm-label {
  font-size: 10px;
  font-weight: 700;
  color: var(--text-dim);
  text-transform: uppercase;
  letter-spacing: 0.06em;
  margin-bottom: 4px;
  margin-top: 10px;
  display: block;
}
.ecm-textarea {
  width: 100%;
  min-height: 72px;
  background: var(--bg);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 9px 12px;
  font-size: 13px;
  font-family: inherit;
  resize: vertical;
  margin: 0;
  min-height: 60px;
}
.ecm-textarea:focus { outline: none; border-color: var(--blue); }
.ecm-save {
  background: var(--blue);
  color: #fff;
  border: none;
  padding: 11px 20px;
  border-radius: var(--radius-sm);
  font-size: 13px;
  font-weight: 700;
  cursor: pointer;
  margin: 14px 0 0;
  min-height: unset;
  width: 100%;
}

/* ── CSV Import Modal ─────────────────────────────────────── */
.csv-modal-backdrop {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.65);
  z-index: 600;
  align-items: flex-end;
  justify-content: center;
}
.csv-modal-backdrop.open { display: flex; }
.csv-modal-sheet {
  background: var(--surface);
  border-radius: 20px 20px 0 0;
  border: 1px solid var(--border);
  padding: 22px 20px 32px;
  width: 100%;
  max-width: 680px;
  max-height: 85vh;
  overflow-y: auto;
  box-shadow: var(--shadow);
}
.csv-modal-title {
  font-size: 16px;
  font-weight: 800;
  color: var(--text);
  margin-bottom: 4px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.csv-modal-sub {
  font-size: 12px;
  color: var(--text-muted);
  margin-bottom: 14px;
}
.csv-settings-row {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-bottom: 14px;
}
.csv-settings-row select,
.csv-settings-row input {
  flex: 1 1 120px;
  min-height: 38px;
  font-size: 12px;
  padding: 7px 10px;
  margin: 0;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  color: var(--text);
}
.csv-textarea {
  width: 100%;
  min-height: 140px;
  background: var(--bg);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 10px 12px;
  font-size: 12px;
  font-family: 'SF Mono', 'Fira Code', monospace;
  resize: vertical;
  margin: 0 0 10px;
}
.csv-textarea:focus { outline: none; border-color: var(--blue); }
.csv-parse-btn {
  background: var(--card);
  color: var(--blue);
  border: 1px solid rgba(59,130,246,0.3);
  padding: 9px 18px;
  border-radius: var(--radius-sm);
  font-size: 12px;
  font-weight: 700;
  cursor: pointer;
  margin: 0;
  min-height: unset;
}
.csv-preview-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 11px;
  margin: 10px 0;
  max-height: 200px;
  overflow-y: auto;
  display: block;
}
.csv-preview-table th {
  background: var(--card);
  color: var(--text-muted);
  padding: 6px 10px;
  text-align: left;
  font-weight: 700;
  text-transform: uppercase;
  font-size: 9px;
  letter-spacing: 0.06em;
  border-bottom: 1px solid var(--border);
  position: sticky;
  top: 0;
}
.csv-preview-table td {
  padding: 6px 10px;
  border-bottom: 1px solid rgba(30,51,80,0.4);
  color: var(--text-muted);
  max-width: 160px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.csv-preview-table tr:hover td { background: rgba(255,255,255,0.025); }
.csv-error-row { color: var(--red) !important; background: rgba(239,68,68,0.06) !important; }
.csv-import-btn {
  background: var(--blue);
  color: #fff;
  border: none;
  padding: 12px 24px;
  border-radius: var(--radius-sm);
  font-size: 14px;
  font-weight: 700;
  cursor: pointer;
  margin: 10px 0 0;
  min-height: unset;
  width: 100%;
}
.csv-import-status {
  font-size: 12px;
  color: var(--blue);
  margin-top: 8px;
  min-height: 16px;
  text-align: center;
}
.csv-column-map {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
  margin-bottom: 10px;
}
.csv-column-map label {
  font-size: 10px;
  font-weight: 700;
  color: var(--text-dim);
  text-transform: uppercase;
  letter-spacing: 0.06em;
  margin-bottom: 2px;
  display: block;
}
.csv-column-map select {
  font-size: 11px;
  margin: 0;
  padding: 6px 8px;
  min-height: 34px;
  width: 100%;
}

/* ── Note → Card Bridge button ────────────────────────────── */
.note-to-cards-btn {
  background: rgba(139,92,246,0.12);
  color: #a78bfa;
  border: 1px solid rgba(139,92,246,0.3);
  padding: 6px 12px;
  border-radius: var(--radius-sm);
  font-size: 12px;
  font-weight: 700;
  cursor: pointer;
  margin: 0;
  min-height: unset;
  transition: background 0.15s;
  white-space: nowrap;
}
.note-to-cards-btn:hover { background: rgba(139,92,246,0.2); opacity: 1; box-shadow: none; }

/* Note→Card modal */
.n2c-modal-backdrop {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.65);
  z-index: 700;
  align-items: flex-end;
  justify-content: center;
}
.n2c-modal-backdrop.open { display: flex; }
.n2c-modal-sheet {
  background: var(--surface);
  border-radius: 20px 20px 0 0;
  border: 1px solid var(--border);
  padding: 22px 20px 32px;
  width: 100%;
  max-width: 660px;
  max-height: 85vh;
  overflow-y: auto;
  box-shadow: var(--shadow);
}

/* Chapter Add button in browse accordion (header level) */
.fc-acc-chapter-head { display: flex; align-items: center; gap: 8px; flex: 1; }

/* ═══════════════════════════════════════════════════════════
   SCREEN ROTATION — Programmatic landscape/portrait toggle
   ═══════════════════════════════════════════════════════════ */

/* The rotate button lives at the bottom of the side nav */
.nav-rotate-btn-wrap {
  flex-shrink: 0;
  border-top: 1px solid var(--border);
  padding: 8px 6px;
}
.rotate-screen-btn {
  display: flex;
  align-items: center;
  gap: 10px;
  width: 100%;
  background: transparent;
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  color: var(--text-muted);
  padding: 8px 10px;
  cursor: pointer;
  font-size: 12px;
  font-weight: 600;
  transition: background 0.15s, color 0.15s;
  margin: 0;
  min-height: unset;
  white-space: nowrap;
  overflow: hidden;
}
.rotate-screen-btn:hover { background: rgba(255,255,255,0.05); color: var(--text); opacity: 1; box-shadow: none; }
.nav-install-pwa-btn { display: flex; align-items: center; gap: 10px; width: 100%; background: transparent; border: 1px solid var(--border); border-radius: var(--radius-sm); color: var(--text-muted); padding: 8px 10px; cursor: pointer; font-size: 12px; font-weight: 600; transition: background 0.15s, color 0.15s; margin: 0; min-height: unset; white-space: nowrap; overflow: hidden; }
.nav-install-pwa-btn:hover { background: rgba(255,255,255,0.05); color: var(--text); opacity: 1; box-shadow: none; }
.nav-theme-btn { display: flex; align-items: center; gap: 10px; width: 100%; background: transparent; border: 1px solid var(--border); border-radius: var(--radius-sm); color: var(--text-muted); padding: 8px 10px; cursor: pointer; font-size: 12px; font-weight: 600; transition: background 0.15s, color 0.15s; margin: 0; margin-bottom: 6px; min-height: unset; white-space: nowrap; overflow: hidden; }
.nav-theme-btn:hover { background: rgba(255,255,255,0.05); color: var(--text); opacity: 1; box-shadow: none; }
.rotate-screen-icon { font-size: 16px; flex-shrink: 0; width: 24px; text-align: center; display: flex; align-items: center; justify-content: center; }
.rotate-screen-label { opacity: 1; transition: opacity 0.2s; overflow: hidden; white-space: nowrap; }

/* Hide the manual rotation button when running as an installed PWA —
   the device handles rotation automatically in standalone mode */
@media (display-mode: standalone) {
  .rotate-screen-btn { display: none !important; }
}


/* ── Rotated state: rotate the entire <html> element 90deg ── */
html.screen-rotated {
  transform-origin: top left;
  transform: rotate(90deg) translateX(0) translateY(-100%);
  width: 100vh;
  height: 100vw;
  overflow: hidden;
  position: fixed;
  top: 0; left: 0;
}
/* Ensure body fills rotated frame and scrolls */
html.screen-rotated body {
  height: 100vw;
  min-height: unset;
  width: 100vh;
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  /* touch-move scroll is handled via JS remapping in rotateScreen.js */
  touch-action: none;
  overscroll-behavior: none;
}
/* Keep fixed elements (modals, bulk bars etc.) sane in rotated mode —
   position is managed by JS getBoundingClientRect which still works */

/* ═══════════════════════════════════════════════════════════
   UI ENHANCEMENTS — All 17 Audit Items
   ═══════════════════════════════════════════════════════════ */

/* ── #1 Skeleton shimmer loading state ── */
@keyframes skeleton-shimmer {
  0%   { background-position: -400% 0; }
  100% { background-position:  400% 0; }
}
.skeleton {
  background: linear-gradient(
    90deg,
    var(--card) 25%,
    rgba(255,255,255,0.07) 50%,
    var(--card) 75%
  );
  background-size: 400% 100%;
  animation: skeleton-shimmer 1.5s ease infinite;
  border-radius: var(--radius-sm);
  color: transparent !important;
  pointer-events: none;
  user-select: none;
}
.skeleton * { visibility: hidden !important; }

/* Common skeleton shapes */
.skeleton-line {
  height: 13px;
  border-radius: 4px;
  margin-bottom: 8px;
}
.skeleton-line.wide  { width: 80%; }
.skeleton-line.short { width: 45%; }
.skeleton-card {
  height: 80px;
  border-radius: var(--radius);
  margin-bottom: 10px;
}
.skeleton-stat {
  height: 56px;
  border-radius: var(--radius);
}

/* ── #11 Page fade-in transition ── */
@keyframes page-fade-in {
  from { opacity: 0; }
  to   { opacity: 1; }
}
body {
  animation: page-fade-in 0.22s ease both;
}

/* ── #12 Button press ripple ── */
button:not(.icon-btn):not(.collapse-btn):not(.fc-icon-btn):not(.tab-btn):not(.fc-tab):not(.rotate-screen-btn):not(.nav-install-pwa-btn):not(.nav-theme-btn):not(.notes-bc-back):not(.notes-edit-btn) {
  position: relative;
  overflow: hidden;
}
button:not(.icon-btn):not(.collapse-btn):not(.fc-icon-btn):not(.tab-btn):not(.fc-tab):not(.rotate-screen-btn):not(.nav-install-pwa-btn):not(.nav-theme-btn):not(.notes-bc-back):not(.notes-edit-btn)::after {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 50% 50%, rgba(255,255,255,0.22) 0%, transparent 65%);
  opacity: 0;
  transition: opacity 0.35s ease;
  pointer-events: none;
  border-radius: inherit;
}
button:not(.icon-btn):not(.collapse-btn):not(.fc-icon-btn):not(.tab-btn):not(.fc-tab):not(.rotate-screen-btn):not(.nav-install-pwa-btn):not(.nav-theme-btn):not(.notes-bc-back):not(.notes-edit-btn):active::after {
  opacity: 1;
  transition: opacity 0s;
}

/* ── #6 Mobile touch :active feedback ── */
@media (hover: none) {
  .card:active,
  .subject-summary-card:active {
    background: rgba(255,255,255,0.03);
    border-color: var(--border-lt);
    transition: background 0.1s, border-color 0.1s;
  }
  .notes-subj-card:active,
  .notes-unit-grid-card:active {
    transform: translateY(-1px);
    border-color: var(--border-lt);
    transition: transform 0.1s, border-color 0.1s;
  }
  .notes-chap-card:active {
    border-color: var(--border-lt);
    background: rgba(59,130,246,0.05);
    transition: background 0.1s, border-color 0.1s;
  }
  .fc-browse-item:active {
    background: rgba(255,255,255,0.03);
    border-color: var(--border-lt);
    transition: background 0.1s, border-color 0.1s;
  }
  .pill:active {
    opacity: 0.7;
    transition: opacity 0.1s;
  }
}

/* ── #4 Flashcard rating buttons — 2-col on tiny screens ── */
@media (max-width: 360px) {
  .fc-rating-buttons { grid-template-columns: repeat(2, 1fr); gap: 6px; }
  .fc-rating-btn { font-size: 11px; padding: 10px 0; }
}

/* ── #8 Editor toolbar consistent small buttons ── */
.toolbar-tool-btn {
  font-size: 12px;
  padding: 5px 10px;
  margin: 0;
  min-height: unset;
  background: var(--card);
  color: var(--text-muted);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  cursor: pointer;
  white-space: nowrap;
  transition: color 0.15s, border-color 0.15s, background 0.15s;
  font-weight: 600;
  font-family: inherit;
}
.toolbar-tool-btn:hover { color: var(--text); border-color: var(--border-lt); opacity: 1; box-shadow: none; }
.toolbar-tool-btn.ai { color: var(--blue); border-color: rgba(59,130,246,0.3); }
.toolbar-tool-btn.ai:hover { background: rgba(59,130,246,0.1); border-color: rgba(59,130,246,0.5); }

/* ── #9 Contextual progress bar fill colors (via JS class) ── */
/* Note: .green/.yellow/.red classes already exist on stat-fill — this ensures they override defaults */
.stat-fill.green  { background: var(--green)  !important; }
.stat-fill.yellow { background: var(--yellow) !important; }
.stat-fill.red    { background: var(--red)    !important; }

/* ── #10 Empty state CTA button inside the empty state ── */
.notes-empty-cta {
  margin-top: 4px;
  background: rgba(59,130,246,0.12);
  color: var(--blue);
  border: 1px solid rgba(59,130,246,0.3);
  padding: 9px 20px;
  border-radius: var(--radius);
  font-size: 13px;
  font-weight: 700;
  cursor: pointer;
  min-height: unset;
  margin-top: 6px;
  transition: background 0.15s, border-color 0.15s;
}
.notes-empty-cta:hover { background: rgba(59,130,246,0.2); border-color: rgba(59,130,246,0.5); opacity: 1; box-shadow: none; }
.fc-screen .fc-screen-cta {
  background: var(--blue);
  color: white;
  padding: 11px 24px;
  border-radius: var(--radius);
  font-size: 14px;
  font-weight: 700;
  cursor: pointer;
  border: none;
  min-height: unset;
  margin-top: 4px;
}

/* ── #14 Notes save status — flash green then fade ── */
@keyframes saved-flash {
  0%   { color: var(--green); opacity: 1; font-weight: 700; }
  40%  { color: var(--green); opacity: 1; font-weight: 700; }
  100% { color: var(--text-dim); opacity: 0.7; font-weight: 400; }
}
#notes-save-status {
  font-size: 11px;
  color: var(--text-dim);
  margin-left: auto;
  white-space: nowrap;
  transition: color 0.3s;
}
#notes-save-status.saved-flash {
  animation: saved-flash 2.2s ease forwards;
}

/* ── #15 Global search overlay open/close animation ── */
#gs-overlay {
  transition: opacity 0.22s ease;
}
#gs-overlay.gs-open {
  opacity: 1 !important;
  pointer-events: auto !important;
}
#gs-overlay #gs-box {
  transform: translateY(-10px);
  transition: transform 0.22s cubic-bezier(.4,0,.2,1);
}
#gs-overlay.gs-open #gs-box {
  transform: translateY(0);
}

/* ── #17 Analytics stat-box — readable on wide desktop ── */
@media (min-width: 860px) {
  .stat-big { font-size: 28px; }
}

/* ================================================================
   NOTES PAGE — NEW FEATURES (11 total)
   ================================================================ */

/* ── Feature 5: Recently edited panel ─────────────────────────── */
.notes-recent-panel {
  padding: 10px 16px 2px;
  border-bottom: 1px solid var(--border);
}
.notes-recent-label {
  font-size: 10px;
  font-weight: 800;
  color: var(--text-dim);
  text-transform: uppercase;
  letter-spacing: .08em;
  margin-bottom: 8px;
}
.notes-recent-chips {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
  padding-bottom: 8px;
}
.notes-recent-chip {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 6px 10px;
  cursor: pointer;
  font-size: 11px;
  color: var(--text);
  font-weight: 600;
  min-height: unset;
  margin: 0;
  transition: border-color .15s, background .15s;
  text-align: left;
  min-width: 0;
  max-width: 150px;
}
.notes-recent-chip:hover { border-color: var(--border-lt); background: rgba(255,255,255,0.04); opacity: 1; box-shadow: none; }
.notes-recent-chip-name {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 130px;
  display: block;
}
.notes-recent-chip-sub {
  font-size: 9px;
  color: var(--text-dim);
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 130px;
  display: block;
  margin-top: 1px;
}

/* ── Feature 4: Tag filter bar ─────────────────────────────────── */
.notes-tag-filter-bar {
  display: flex;
  align-items: center;
  gap: 6px;
  flex-wrap: wrap;
  padding: 8px 16px 6px;
  border-bottom: 1px solid var(--border);
  background: var(--surface);
}
.notes-tag-filter-label {
  font-size: 10px;
  font-weight: 800;
  color: var(--text-dim);
  text-transform: uppercase;
  letter-spacing: .07em;
  flex-shrink: 0;
}
.notes-tag-pill {
  background: var(--card);
  border: 1px solid var(--border);
  color: var(--text-muted);
  font-size: 11px;
  font-weight: 600;
  padding: 4px 10px;
  border-radius: 20px;
  cursor: pointer;
  margin: 0;
  min-height: unset;
  transition: background .12s, color .12s, border-color .12s;
  white-space: nowrap;
  font-family: inherit;
}
.notes-tag-pill:hover  { border-color: var(--blue); color: var(--blue); opacity: 1; box-shadow: none; }
.notes-tag-pill.active { background: rgba(59,130,246,0.15); color: var(--blue); border-color: rgba(59,130,246,0.5); }

/* ── Feature 3+10: Chapter pills (revision status actions) ────── */
.notes-chap-right {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 4px;
  flex-shrink: 0;
}
.notes-chap-pills {
  display: flex;
  gap: 3px;
  flex-wrap: wrap;
  justify-content: flex-end;
}
.notes-chap-pill {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 9px;
  font-weight: 800;
  padding: 3px 6px;
  border-radius: 5px;
  cursor: pointer;
  border: 1px solid transparent;
  transition: background .12s, color .12s, border-color .12s;
  user-select: none;
  min-width: 22px;
  min-height: 22px;
  line-height: 1;
}
.notes-chap-pill.comp          { background: rgba(100,116,139,0.1); color: var(--text-dim); border-color: rgba(100,116,139,0.2); }
.notes-chap-pill.comp.active   { background: rgba(16,185,129,0.15); color: #10b981; border-color: rgba(16,185,129,0.4); }
.notes-chap-pill.comp:hover    { border-color: rgba(16,185,129,0.5); color: #10b981; }
.notes-chap-pill.r1            { background: rgba(100,116,139,0.1); color: var(--text-dim); border-color: rgba(100,116,139,0.2); }
.notes-chap-pill.r1.active     { background: rgba(29,78,216,0.15);  color: #60a5fa; border-color: rgba(29,78,216,0.4); }
.notes-chap-pill.r1:hover      { border-color: rgba(29,78,216,0.5); color: #60a5fa; }
.notes-chap-pill.r2            { background: rgba(100,116,139,0.1); color: var(--text-dim); border-color: rgba(100,116,139,0.2); }
.notes-chap-pill.r2.active     { background: rgba(217,119,6,0.15);  color: #f59e0b; border-color: rgba(217,119,6,0.4); }
.notes-chap-pill.r2:hover      { border-color: rgba(217,119,6,0.5); color: #f59e0b; }
.notes-chap-pill.r3            { background: rgba(100,116,139,0.1); color: var(--text-dim); border-color: rgba(100,116,139,0.2); }
.notes-chap-pill.r3.active     { background: rgba(124,58,237,0.15); color: #a78bfa; border-color: rgba(124,58,237,0.4); }
.notes-chap-pill.r3:hover      { border-color: rgba(124,58,237,0.5); color: #a78bfa; }

/* ── Feature 9: Note type selector grid ─────────────────────────── */
.notes-type-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  padding-top: 8px;
}
.notes-type-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 14px 12px;
  cursor: pointer;
  display: flex;
  align-items: flex-start;
  gap: 10px;
  transition: border-color .18s, background .15s, transform .12s;
  position: relative;
  min-height: 90px;
}
.notes-type-card:hover { border-color: var(--border-lt); background: rgba(255,255,255,0.03); transform: translateY(-1px); }
.notes-type-card.has-note { border-color: rgba(59,130,246,0.25); }
.notes-type-card-icon {
  font-size: 22px;
  flex-shrink: 0;
  line-height: 1;
  margin-top: 1px;
}
.notes-type-card-body { flex: 1; min-width: 0; }
.notes-type-card-label {
  font-size: 13px;
  font-weight: 700;
  color: var(--text);
  line-height: 1.3;
  margin-bottom: 3px;
}
.notes-type-card-desc {
  font-size: 11px;
  color: var(--text-dim);
  line-height: 1.4;
  overflow: hidden;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  line-clamp: 2;
  -webkit-box-orient: vertical;
}
.notes-type-card-date {
  font-size: 10px;
  color: var(--text-dim);
  margin-top: 4px;
}
.notes-type-card-action {
  position: absolute;
  bottom: 8px; right: 10px;
  font-size: 10px;
  font-weight: 700;
  color: var(--blue);
  background: rgba(59,130,246,0.1);
  border-radius: 4px;
  padding: 2px 6px;
  white-space: nowrap;
}

/* ── Feature 1: Markdown toolbar ─────────────────────────────── */
.notes-md-toolbar {
  display: flex;
  align-items: center;
  gap: 3px;
  padding: 6px 12px;
  border-bottom: 1px solid var(--border);
  background: var(--surface);
  flex-wrap: wrap;
  overflow-x: auto;
  -ms-overflow-style: none;
  scrollbar-width: none;
}
.notes-md-toolbar::-webkit-scrollbar { display: none; }
.md-btn {
  background: transparent;
  border: 1px solid transparent;
  color: var(--text-muted);
  font-size: 11px;
  font-weight: 700;
  padding: 4px 7px;
  border-radius: 5px;
  cursor: pointer;
  min-height: unset;
  margin: 0;
  font-family: inherit;
  white-space: nowrap;
  line-height: 1.3;
  transition: background .12s, color .12s, border-color .12s;
  flex-shrink: 0;
}
.md-btn:hover { background: var(--card); border-color: var(--border); color: var(--text); opacity: 1; box-shadow: none; }
.md-btn.tmpl  { color: var(--blue); font-size: 10px; background: rgba(59,130,246,0.07); border-color: rgba(59,130,246,0.2); }
.md-btn.tmpl:hover { background: rgba(59,130,246,0.15); border-color: rgba(59,130,246,0.4); }
.md-divider {
  width: 1px;
  height: 16px;
  background: var(--border);
  flex-shrink: 0;
  margin: 0 3px;
  align-self: center;
}

/* ── Feature 7: Find in note bar ─────────────────────────────── */
.notes-find-bar {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 7px 14px;
  background: rgba(245,158,11,0.07);
  border-bottom: 1px solid rgba(245,158,11,0.25);
  position: sticky;
  top: 0;
  z-index: 35;
}
.notes-find-input {
  flex: 1;
  background: var(--card);
  border: 1px solid rgba(245,158,11,0.4);
  color: var(--text);
  font-size: 13px;
  padding: 6px 12px;
  border-radius: var(--radius-sm);
  outline: none;
  min-height: unset;
  font-family: inherit;
}
.notes-find-input:focus { border-color: rgba(245,158,11,0.7); }
.notes-find-count {
  font-size: 11px;
  color: var(--text-dim);
  white-space: nowrap;
  flex-shrink: 0;
  min-width: 60px;
  text-align: right;
}
.notes-find-highlight {
  background: rgba(250,204,21,0.4) !important;
  color: var(--text) !important;
  border-radius: 2px;
  padding: 0 1px;
}

/* ── Note type badge in topbar ────────────────────────────────── */
.notes-note-type-badge {
  font-size: 16px;
  flex-shrink: 0;
  line-height: 1;
}

/* ── Feature 6: Focus mode ────────────────────────────────────── */
body.notes-focus-mode .notes-breadcrumb-bar,
body.notes-focus-mode .notes-search-bar,
body.notes-focus-mode .notes-progress-bar,
body.notes-focus-mode #nav-bar,
body.notes-focus-mode .nav-bottom,
body.notes-focus-mode .notes-note-topbar > *:not(#btn-focus-mode):not(.notes-note-topbar-title) {
  display: none !important;
}
body.notes-focus-mode .notes-note-topbar {
  justify-content: space-between;
  padding: 8px 14px;
}
body.notes-focus-mode .notes-note-topbar-title { display: block !important; }
body.notes-focus-mode #btn-focus-mode { display: inline-flex !important; }
body.notes-focus-mode .notes-read-body,
body.notes-focus-mode .notes-md-editor {
  padding: 28px 24px 80px;
  font-size: 16px !important;
  line-height: 1.8 !important;
}
body.notes-focus-mode .notes-edit-wrap { padding-top: 8px; }
body.notes-focus-mode .notes-md-toolbar { display: none !important; }

/* ── Mobile responsive for all new features ─────────────────────── */
@media (max-width: 600px) {
  /* Note type grid: 1 col on tiny screens */
  .notes-type-grid { grid-template-columns: 1fr; gap: 8px; }

  /* Chapter cards: stack pills below the chapter info */
  .notes-chap-card { flex-wrap: wrap; }
  .notes-chap-right { flex-direction: row; align-items: center; flex-wrap: wrap; gap: 3px; width: 100%; justify-content: flex-start; margin-top: 6px; padding-top: 6px; border-top: 1px solid var(--border); }
  .notes-chap-pills { justify-content: flex-start; }
  .notes-chap-pill  { min-height: 28px; min-width: 28px; font-size: 10px; padding: 4px 8px; }

  /* Markdown toolbar: scroll horizontally */
  .notes-md-toolbar { flex-wrap: nowrap; overflow-x: auto; padding: 5px 10px; gap: 4px; }
  .md-btn { min-height: 30px; padding: 4px 8px; font-size: 11px; }

  /* Find bar */
  .notes-find-bar { padding: 6px 10px; gap: 6px; }
  .notes-find-input { font-size: 14px; padding: 8px 10px; }

  /* Recently edited: allow horizontal scroll */
  .notes-recent-chips { flex-wrap: nowrap; overflow-x: auto; padding-bottom: 10px; -webkit-overflow-scrolling: touch; }
  .notes-recent-chip  { flex-shrink: 0; }

  /* Tag filter: horizontal scroll */
  .notes-tag-filter-bar { flex-wrap: nowrap; overflow-x: auto; -webkit-overflow-scrolling: touch; }
  .notes-tag-pill       { flex-shrink: 0; }

  /* Note topbar: wrap on small screens */
  .notes-note-topbar { gap: 5px; padding: 8px 10px; }
  .notes-note-topbar-title { font-size: 13px; }
  .notes-edit-btn { font-size: 11px; padding: 5px 8px; }
  .note-font-select { display: none; }  /* hide font picker on mobile to save space */

  /* Type card: adjust layout */
  .notes-type-card { padding: 12px 10px; min-height: 75px; }
  .notes-type-card-icon { font-size: 20px; }
  .notes-type-card-label { font-size: 12px; }
  .notes-type-card-desc { font-size: 10px; }
}

@media (max-width: 380px) {
  .notes-type-grid { gap: 6px; }
  .notes-chap-pill { min-height: 26px; min-width: 26px; font-size: 9px; padding: 3px 6px; }
  .md-btn { min-height: 28px; padding: 3px 6px; font-size: 10px; }
}

/* Touch feedback for new interactive elements */
@media (hover: none) {
  .notes-recent-chip:active { background: rgba(255,255,255,0.06); border-color: var(--border-lt); transition: background .1s; }
  .notes-tag-pill:active     { opacity: 0.7; transition: opacity .1s; }
  .notes-chap-pill:active    { opacity: 0.6; transition: opacity .1s; }
  .notes-type-card:active    { transform: translateY(-1px); border-color: var(--border-lt); }
  .md-btn:active             { background: var(--card); opacity: 0.7; }
}

/* ═══════════════════════════════════════════════════════════
   NOTES RIGHT SIDEBAR — Quick chapter/unit switcher
   ═══════════════════════════════════════════════════════════ */

/* Tab toggle button — right edge, mirrors left #nav-toggle-btn */
#notes-rn-toggle {
  position: fixed;
  top: 68px;
  right: 0;
  z-index: 210;
  width: 22px;
  height: 52px;
  min-height: unset;
  padding: 0;
  margin: 0;
  background: var(--surface);
  border: 1px solid var(--border);
  border-right: none;
  border-radius: 8px 0 0 8px;
  color: var(--text-muted);
  font-size: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: right 0.28s cubic-bezier(.4,0,.2,1), color 0.15s, background 0.15s;
  box-shadow: -2px 0 8px rgba(0,0,0,0.4);
  line-height: 1;
  writing-mode: vertical-rl;
  letter-spacing: 0.06em;
  font-weight: 700;
}
#notes-rn-toggle.open { right: var(--nav-w); }
#notes-rn-toggle:hover { color: var(--text); background: var(--card); box-shadow: -2px 0 14px rgba(0,0,0,0.55); }

/* Panel */
#notes-right-nav {
  position: fixed;
  top: 0; right: 0; bottom: 0;
  width: var(--nav-w);
  background: rgba(10,18,36,0.98);
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
  border-left: 1px solid var(--border);
  display: flex;
  flex-direction: column;
  z-index: 200;
  transform: translateX(100%);
  transition: transform 0.28s cubic-bezier(.4,0,.2,1);
  box-shadow: -2px 0 28px rgba(0,0,0,0.5);
  overflow: hidden;
}
#notes-right-nav.open { transform: translateX(0); }

/* Header */
.notes-rn-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  padding: 13px 14px 11px;
  border-bottom: 1px solid var(--border);
  flex-shrink: 0;
  min-height: 50px;
}
.notes-rn-subject-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  background: rgba(59,130,246,0.1);
  border: 1px solid rgba(59,130,246,0.25);
  color: var(--blue);
  font-size: 11px;
  font-weight: 700;
  padding: 4px 10px;
  border-radius: var(--radius-sm);
  cursor: pointer;
  min-height: unset;
  margin: 0;
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;
  max-width: 140px;
  flex: 1;
  min-width: 0;
}
.notes-rn-subject-btn:hover { background: rgba(59,130,246,0.18); opacity: 1; }
.notes-rn-close-btn {
  background: transparent;
  border: 1px solid var(--border);
  color: var(--text-dim);
  font-size: 13px;
  padding: 4px 9px;
  border-radius: var(--radius-sm);
  cursor: pointer;
  min-height: unset;
  margin: 0;
  flex-shrink: 0;
  line-height: 1;
}
.notes-rn-close-btn:hover { color: var(--text); }

/* Scrollable body */
.notes-rn-body {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 6px 0 24px;
}

/* All-subjects list */
.notes-rn-subject-row {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 11px 16px;
  font-size: 13px;
  font-weight: 600;
  color: var(--text-muted);
  cursor: pointer;
  transition: color 0.15s, background 0.15s;
  border-left: 2px solid transparent;
}
.notes-rn-subject-row:hover { color: var(--text); background: rgba(255,255,255,0.04); }
.notes-rn-subject-row.active { color: var(--blue); background: rgba(59,130,246,0.07); border-left-color: var(--blue); }
.notes-rn-subject-row svg { flex-shrink: 0; opacity: 0.7; }

/* Unit group */
.notes-rn-unit { margin-bottom: 1px; }

.notes-rn-unit-head {
  display: flex;
  align-items: center;
  gap: 7px;
  padding: 9px 14px;
  font-size: 10px;
  font-weight: 700;
  color: var(--text-dim);
  text-transform: uppercase;
  letter-spacing: 0.07em;
  cursor: pointer;
  user-select: none;
  transition: color 0.15s, background 0.15s;
  position: relative;
}
.notes-rn-unit-head:hover { color: var(--text-muted); background: rgba(255,255,255,0.03); }
.notes-rn-unit-head.active { color: var(--blue); }
.notes-rn-unit-arrow {
  font-size: 8px;
  flex-shrink: 0;
  width: 10px;
  transition: transform 0.18s;
  display: inline-block;
}
.notes-rn-unit-arrow.open { transform: rotate(90deg); }
.notes-rn-unit-name { flex: 1; min-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.notes-rn-unit-count {
  background: rgba(255,255,255,0.07);
  color: var(--text-dim);
  font-size: 9px;
  padding: 1px 5px;
  border-radius: 20px;
  flex-shrink: 0;
}

/* Chapter items */
.notes-rn-chapters { overflow: hidden; }

.notes-rn-chapter {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 14px 8px 30px;
  font-size: 12px;
  color: var(--text-dim);
  cursor: pointer;
  transition: color 0.15s, background 0.15s;
  border-left: 2px solid transparent;
  word-break: break-word;
  line-height: 1.35;
}
.notes-rn-chapter:hover { color: var(--text-muted); background: rgba(255,255,255,0.04); }
.notes-rn-chapter.has-note { color: var(--text-muted); }
.notes-rn-chapter.active {
  color: var(--blue);
  background: rgba(59,130,246,0.09);
  border-left-color: var(--blue);
  font-weight: 600;
}
.notes-rn-chapter-dot {
  flex-shrink: 0;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: var(--border);
  margin-top: 1px;
}
.notes-rn-chapter.has-note .notes-rn-chapter-dot { background: var(--blue); opacity: 0.7; }
.notes-rn-chapter.active .notes-rn-chapter-dot { background: var(--blue); opacity: 1; }
.notes-rn-chapter-name { flex: 1; min-width: 0; }

/* Mobile */
@media (max-width: 480px) {
  #notes-right-nav { width: 88vw; }
  #notes-rn-toggle.open { right: 88vw; }
}
@media (hover: none) {
  .notes-rn-chapter:active { background: rgba(255,255,255,0.05); }
  .notes-rn-unit-head:active { background: rgba(255,255,255,0.04); }
}

/* ═══════════════════════════════════════════════════════════
   Global Popup System — toasts · confirm · prompt
   ═══════════════════════════════════════════════════════════ */

/* ── Toast notifications ──────────────────────────────────── */
.gs-toast-wrap {
  position: fixed;
  bottom: 24px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 99999;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  pointer-events: none;
  width: max-content;
  max-width: calc(100vw - 32px);
}
.gs-toast {
  display: flex;
  align-items: center;
  gap: 10px;
  background: #1a2840;
  border: 1px solid var(--border-lt);
  border-left: 3px solid var(--border-lt);
  border-radius: 12px;
  padding: 11px 18px 11px 14px;
  font-size: 13px;
  font-weight: 500;
  color: var(--text);
  box-shadow: 0 8px 30px rgba(0,0,0,0.55);
  pointer-events: auto;
  cursor: pointer;
  animation: gsToastIn .22s cubic-bezier(.22,1,.36,1);
  max-width: 380px;
  line-height: 1.4;
}
.gs-toast.out       { animation: gsToastOut .18s ease forwards; }
.gs-toast.gs-success { border-left-color: var(--green); }
.gs-toast.gs-error   { border-left-color: var(--red); }
.gs-toast.gs-warn    { border-left-color: var(--yellow); }
.gs-toast.gs-info    { border-left-color: var(--blue); }
.gs-toast-icon { font-size: 15px; flex-shrink: 0; }
@keyframes gsToastIn {
  from { opacity: 0; transform: translateY(14px) scale(.97); }
  to   { opacity: 1; transform: translateY(0)    scale(1);   }
}
@keyframes gsToastOut {
  to { opacity: 0; transform: translateY(8px); }
}

/* ── Confirm / Prompt modals ──────────────────────────────── */
.gs-modal-backdrop {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(5, 12, 26, 0.78);
  z-index: 99990;
  align-items: center;
  justify-content: center;
  padding: 20px;
  backdrop-filter: blur(2px);
  animation: gsFadeIn .15s ease;
}
.gs-modal-backdrop.open { display: flex; }
@keyframes gsFadeIn { from { opacity: 0; } to { opacity: 1; } }
.gs-modal-box {
  background: #152030;
  border: 1px solid var(--border-lt);
  border-radius: var(--radius-lg);
  padding: 26px 24px 20px;
  max-width: 400px;
  width: 100%;
  box-shadow: 0 24px 64px rgba(0,0,0,0.7);
  animation: gsSlideUp .2s cubic-bezier(.22,1,.36,1);
}
@keyframes gsSlideUp {
  from { opacity: 0; transform: translateY(16px); }
  to   { opacity: 1; transform: translateY(0);    }
}
.gs-modal-icon  { font-size: 26px; margin-bottom: 10px; line-height: 1; }
.gs-modal-title { font-size: 16px; font-weight: 800; color: var(--text); margin-bottom: 6px; }
.gs-modal-body  { font-size: 13px; color: var(--text-muted); margin-bottom: 20px; line-height: 1.6; }
.gs-modal-btns  { display: flex; gap: 10px; justify-content: flex-end; }
.gs-btn-cancel {
  background: var(--card);
  color: var(--text-muted);
  border: 1px solid var(--border);
  padding: 9px 18px;
  border-radius: var(--radius-sm);
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  margin: 0;
  min-height: unset;
  transition: background .15s, color .15s;
}
.gs-btn-cancel:hover { background: var(--border); color: var(--text); }
.gs-btn-ok {
  background: var(--blue);
  color: #fff;
  border: none;
  padding: 9px 18px;
  border-radius: var(--radius-sm);
  font-size: 13px;
  font-weight: 700;
  cursor: pointer;
  margin: 0;
  min-height: unset;
  transition: opacity .15s;
}
.gs-btn-ok:hover  { opacity: .88; }
.gs-btn-ok.danger { background: var(--red); }
.gs-prompt-input {
  width: 100%;
  background: var(--bg);
  border: 1.5px solid var(--border-lt);
  border-radius: var(--radius-sm);
  color: var(--text);
  font-size: 14px;
  padding: 10px 12px;
  margin-bottom: 18px;
  outline: none;
  transition: border-color .15s;
}
.gs-prompt-input:focus { border-color: var(--blue); }
@media (max-width: 480px) {
  .gs-modal-btns { flex-direction: column; }
  .gs-btn-cancel, .gs-btn-ok { width: 100%; text-align: center; }
}


/* ════════════════════════════════════════════════════════════
   LIGHT MODE  (body.light)
   ════════════════════════════════════════════════════════════ */

/* Smooth theme transition — applied on body.light entering, and body.theme-transitioning for switching back */
body.light *,
body.theme-transitioning * {
  transition: background-color 0.22s ease, border-color 0.22s ease,
              color 0.18s ease, box-shadow 0.22s ease !important;
}
/* Exclude elements where constant transitions would cause jitter */
body.light *::before, body.light *::after,
body.theme-transitioning *::before, body.theme-transitioning *::after,
body.light canvas, body.theme-transitioning canvas {
  transition: none !important;
}

/* ── CSS Custom Properties ── */
body.light {
  --bg:         #eef2f7;
  --surface:    #ffffff;
  --card:       #f4f7fb;
  --border:     #dde3ed;
  --border-lt:  #c4cfe0;
  --text:       #0f172a;
  --text-muted: #455368;
  --text-dim:   #7c93ad;
  --shadow-sm:  0 1px 8px rgba(15,30,60,0.07), 0 2px 16px rgba(15,30,60,0.05);
  --shadow:     0 4px 24px rgba(15,30,60,0.10), 0 1px 4px rgba(15,30,60,0.06);
}

/* ── Base body ── */
body.light {
  background: #eef2f7;
  color: var(--text);
}
@media (min-width: 860px) {
  body.light {
    background-image:
      radial-gradient(ellipse at 18% 12%, rgba(59,130,246,0.07) 0%, transparent 50%),
      radial-gradient(ellipse at 82% 88%, rgba(139,92,246,0.05) 0%, transparent 50%);
  }
  body.light .card:hover     { box-shadow: 0 8px 32px rgba(15,30,60,0.13); }
  body.light .card { box-shadow: var(--shadow-sm); }
}

/* ── Sticky page header (h1) ── */
body.light h1 {
  background: rgba(238,242,247,0.96);
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
  color: var(--text);
  border-bottom-color: var(--border);
  border-image: linear-gradient(180deg, var(--blue) 0%, var(--purple) 100%) 1;
}
body.light h1::after {
  background: linear-gradient(90deg, rgba(59,130,246,0.2) 0%, rgba(139,92,246,0.12) 60%, transparent 100%);
}

/* ── Side Nav ── */
body.light .side-nav {
  background: rgba(255,255,255,0.98);
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
  border-right-color: var(--border);
  box-shadow: 4px 0 24px rgba(15,30,60,0.09);
}
body.light .side-nav-brand        { border-bottom-color: var(--border); }
body.light .side-nav-brand-text   { color: var(--text); }
body.light .side-nav-item         { color: var(--text-muted); }
body.light .side-nav-item:hover   { background: rgba(59,130,246,0.05); color: var(--text); }
body.light .side-nav-item.active  { background: rgba(59,130,246,0.08); color: var(--blue); }
body.light #nav-overlay           { background: rgba(15,23,42,0.35); }
body.light .nav-rotate-btn-wrap   { border-top-color: var(--border); }

/* ── Nav icon bubbles — keep vibrant in light ── */
body.light .side-nav-item[data-label="Home"]     .side-nav-icon { background: rgba(59,130,246,0.10); }
body.light .side-nav-item[data-label="Planner"]  .side-nav-icon { background: rgba(139,92,246,0.10); }
body.light .side-nav-item[data-label="Syllabus"] .side-nav-icon { background: rgba(16,185,129,0.10); }
body.light .side-nav-item[data-label="Stats"]    .side-nav-icon { background: rgba(245,158,11,0.10); }
body.light .side-nav-item[data-label="Profile"]  .side-nav-icon { background: rgba(14,165,233,0.10); }
body.light .side-nav-item[data-label="Review"]   .side-nav-icon { background: rgba(239,68,68,0.10); }
body.light .side-nav-item[data-label="Cards"]    .side-nav-icon { background: rgba(168,85,247,0.10); }
body.light .side-nav-item[data-label="Notes"]    .side-nav-icon { background: rgba(20,184,166,0.10); }

/* ── Nav toggle tab button ── */
body.light #nav-toggle-btn {
  background: #e0eaf8;
  border-color: rgba(59,130,246,0.4);
  color: #2563eb;
  box-shadow: 2px 0 12px rgba(59,130,246,0.15), 2px 0 4px rgba(0,0,0,0.06);
}
body.light #nav-toggle-btn.open  { background: #e0eaf8; left: var(--nav-w); }
body.light #nav-toggle-btn:hover { background: #c7d9f7; color: #1d4ed8; box-shadow: 2px 0 16px rgba(59,130,246,0.3), 2px 0 4px rgba(0,0,0,0.08); }

/* ── Nav bottom buttons (theme / install / landscape) ── */
body.light .nav-theme-btn,
body.light .nav-install-pwa-btn,
body.light .rotate-screen-btn {
  background: rgba(15,30,60,0.04);
  border-color: var(--border);
  color: var(--text-muted);
}
body.light .nav-theme-btn:hover { background: rgba(245,158,11,0.10); border-color: rgba(245,158,11,0.4); color: #b45309; }
body.light .nav-install-pwa-btn:hover { background: rgba(59,130,246,0.08); border-color: rgba(59,130,246,0.35); color: var(--blue); }
body.light .rotate-screen-btn:hover  { background: rgba(16,185,129,0.08); border-color: rgba(16,185,129,0.35); color: #059669; }

/* ── Cards, surfaces ── */
body.light .card               { background: var(--card); border-color: var(--border); }
body.light .tab-bar            { background: var(--card); border-color: var(--border); }
body.light .tab-btn            { color: var(--text-muted); }
body.light .tab-btn:hover      { background: rgba(15,30,60,0.06); color: var(--text); }
body.light .tab-btn.active     { background: var(--blue); color: #fff; }
body.light .stat-box           { background: #f0f5fc; border-color: var(--border); }
body.light .phase-item         { background: #f0f5fc; border-color: var(--border); }
body.light .section-title      { color: var(--text-muted); }

/* ── Buttons ── */
/* NOTE: body.light button color left to cascade — class rules on specific buttons handle their own colors */
body.light .delete-btn         { background: rgba(239,68,68,0.08); color: #dc2626; border-color: rgba(239,68,68,0.25); }
body.light .delete-btn:hover   { background: var(--red); color: #fff; }
body.light .icon-btn           { color: var(--text-dim); }
body.light .icon-btn:hover     { color: var(--red); background: rgba(239,68,68,0.08); }
body.light .collapse-btn       { color: var(--text-dim); }
body.light .collapse-btn:hover { color: var(--text); background: var(--border); }
body.light .pill               { background: rgba(15,30,60,0.05); color: var(--text-muted); border-color: var(--border); }

/* ── Inputs / selects / textareas ── */
body.light input:not([type="checkbox"]):not([type="radio"]):not([type="file"]):not([type="range"]),
body.light select,
body.light textarea {
  background: #fff;
  color: var(--text);
  border-color: var(--border);
  box-shadow: 0 1px 3px rgba(15,30,60,0.06);
}
body.light input:focus, body.light select:focus, body.light textarea:focus {
  border-color: var(--blue);
  box-shadow: 0 0 0 3px rgba(59,130,246,0.12);
}
body.light select {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='7' viewBox='0 0 12 7'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%23455368' stroke-width='1.8' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 12px center;
}
body.light option                  { background: #fff; color: var(--text, #0f172a); }
body.light label { color: var(--text-muted); }

/* ── Progress bars ── */
body.light .stat-bar,
body.light .fc-progress-bar,
body.light .notes-progress-track  { background: rgba(15,30,60,0.09); }
body.light .rev-bar-track          { background: #d1d9e6; }
body.light .rev-bar-pct            { color: var(--text-dim); }

/* ── Skeleton shimmer ── */
body.light .skeleton {
  background: linear-gradient(90deg, #e8edf5 25%, #f4f7fb 50%, #e8edf5 75%);
  background-size: 400% 100%;
}

/* ── Editor: Subject & Unit ── */
body.light .subject-card         { background: var(--card); border-color: var(--border); }
body.light .subject-card:hover   { border-color: var(--border-lt); }
body.light .subject-title        { color: var(--text); }
body.light .subject-summary-card { background: var(--card); border-color: var(--border); }
body.light .unit-block           { background: #edf2fa; border-color: var(--border); }
body.light .unit-title           { color: var(--text-muted); }
body.light .qbank-unit-row       { background: #edf2fa; border-color: var(--border); }
body.light .chapter-row          { border-top-color: var(--border); }
body.light .topic-row            { border-top-color: var(--border); }
body.light .topic-name           { color: var(--text-muted); }
body.light .chapter-overdue      { background: rgba(239,68,68,0.04); border-left-color: var(--red); }
body.light .badge-overdue        { background: rgba(239,68,68,0.08); color: #b91c1c; border-color: rgba(239,68,68,0.25); }

/* ── Editor: inline helpers ── */
body.light .inline-rename-input   { background: #fff; color: var(--text); border-color: var(--blue); }
body.light .edit-name-btn         { color: var(--text-dim); }
body.light .edit-name-btn:hover   { color: var(--blue); opacity: 1; }
body.light .reorder-btn           { background: transparent; border-color: var(--border); color: var(--text-muted); }
body.light .reorder-btn:hover     { border-color: var(--border-lt); color: var(--text); }
body.light .fc-upload-box         { border-color: var(--border-lt); color: var(--text-muted); }
body.light .fc-upload-box:hover   { border-color: var(--blue); color: var(--blue); }

/* ── Topic chips ── */
body.light .topic-chip { background: #e8eef7; color: var(--text-muted); border-color: var(--border-lt); }
body.light .topic-chip:hover  { border-color: var(--blue); color: var(--blue); background: rgba(59,130,246,0.08); }
body.light .topic-chip.selected { background: rgba(59,130,246,0.12) !important; color: var(--blue) !important; border-color: var(--blue) !important; }
body.light .topic-chip.already-done { background: #d1fae5; color: #065f46; border-color: #6ee7b7; }
body.light .topic-chip.already-done.selected { background: #a7f3d0 !important; border-color: #10b981 !important; }

/* ── Form sections ── */
body.light .form-section          { background: #f0f5fc; border-color: var(--border); }
body.light .form-section-title    { color: var(--text); }

/* ── Flashcards ── */
body.light .fc-tabs               { background: var(--surface); border-bottom-color: var(--border); }
body.light .fc-tab                { color: var(--text-muted); }
body.light .fc-tab.active         { color: var(--blue); border-bottom-color: var(--blue); }
body.light .fc-face               { background: var(--card); border-color: var(--border-lt); box-shadow: 0 4px 24px rgba(15,30,60,0.09); }
body.light .fc-face.fc-back       { background: #eef4ff; }
body.light .fc-face-text          { color: var(--text); }
body.light .fc-tap-hint           { color: var(--text-dim); }
body.light .fc-progress-label,
body.light .fc-progress-label     { color: var(--text-dim); }
body.light .fc-review-header      { color: var(--text-muted); }
body.light .fc-big-count          { color: var(--text); }
body.light .fc-sub-text           { color: var(--text-muted); }
body.light .fc-summary-cell       { background: var(--card); border-color: var(--border); }
body.light .fc-sc-label           { color: var(--text-muted); }
body.light .fc-rating-btn[data-r="1"] { background: rgba(220,38,38,0.09);  color: #b91c1c; }
body.light .fc-rating-btn[data-r="2"] { background: rgba(180,83,9,0.09);   color: #b45309; }
body.light .fc-rating-btn[data-r="3"] { background: rgba(5,150,105,0.09);  color: #047857; }
body.light .fc-rating-btn[data-r="4"] { background: rgba(37,99,235,0.09);  color: #1d4ed8; }

/* ── Flashcard type toggles ── */
body.light .fc-type-btn           { background: var(--card); border-color: var(--border); color: var(--text-muted); }
body.light .fc-type-btn.active    { background: var(--blue); color: #fff; border-color: var(--blue); }
body.light .fc-icon-btn           { background: #f0f5fc; border-color: var(--border); color: var(--text-muted); }
body.light .fc-icon-btn:hover     { border-color: var(--blue); color: var(--blue); }
body.light .fc-tag-wrap,
body.light .fc-quick-add-textarea { background: #fff; border-color: var(--border); color: var(--text); }
body.light .fc-tag-chip           { background: rgba(59,130,246,0.10); color: var(--blue); }
body.light .fc-tag-chip-x         { color: var(--text-dim); }
body.light .fc-btn-secondary      { background: var(--card); border-color: var(--border); color: var(--text); }
body.light .fc-cloze-hint         { background: rgba(59,130,246,0.06); border-color: rgba(59,130,246,0.18); color: var(--text-muted); }
body.light .fc-modal-sheet { background: var(--surface); border-color: var(--border); }
body.light .fc-modal-title        { color: var(--text); }
body.light .fc-ai-card            { background: var(--card); border-color: var(--border); }
body.light .fc-ai-card-header     { color: var(--text-muted); }
body.light .fc-ai-card textarea   { color: var(--text); }

/* ── Flashcard browse ── */
body.light .fc-filters .fc-filter-select { background: #fff; }
body.light .fc-browse-item         { background: var(--card); border-color: var(--border); }
body.light .fc-bi-front            { color: var(--text); }
body.light .fc-bi-meta             { color: var(--text-muted); }
body.light .fc-card-stats-pill     { background: #f0f5fc; border-color: var(--border); color: var(--text-dim); }
body.light .fc-browse-subtab       { background: var(--card); border-color: var(--border); color: var(--text-muted); }
body.light .fc-browse-subtab:hover:not(.active) { background: rgba(15,30,60,0.06); color: var(--text); border-color: var(--border-lt); }
body.light .fc-acc-subject         { border-left-color: transparent; }
body.light .fc-acc-subject.open    { border-left-color: var(--blue); }
body.light .fc-acc-subject-head    { background: var(--surface); border-bottom-color: var(--border); }
body.light .fc-acc-subject-head:hover { background: rgba(59,130,246,0.04); }
body.light .fc-acc-subject-name    { color: var(--text); }
body.light .fc-acc-subject-count   { background: #edf2fa; border-color: var(--border); color: var(--text-muted); }
body.light .fc-acc-subject-count.has-due { background: rgba(239,68,68,0.08); color: var(--red); border-color: rgba(239,68,68,0.2); }
body.light .fc-acc-chevron         { color: var(--text-dim); }
body.light .fc-acc-unit            { border-bottom-color: var(--border); }
body.light .fc-acc-unit-head       { background: rgba(15,30,60,0.02); }
body.light .fc-acc-unit-head:hover { background: rgba(59,130,246,0.04); }
body.light .fc-acc-unit-name       { color: var(--text-muted); }
body.light .fc-acc-unit.open .fc-acc-unit-name { color: var(--text); }
body.light .fc-acc-chapter         { background: transparent; border-bottom-color: rgba(200,210,224,0.6); }
body.light .fc-acc-chapter-name    { color: var(--text-muted); }
body.light .fc-acc-chapter-count   { background: rgba(15,30,60,0.06); color: var(--text-dim); }
body.light .fc-acc-chapter-head:hover { background: rgba(59,130,246,0.04); }
body.light .fc-acc-collapse-btn:hover { background: rgba(15,30,60,0.06); }
body.light .fc-acc-unit-count      { background: rgba(15,30,60,0.06); color: var(--text-dim); }
body.light .fc-card-row            { background: transparent; border-bottom-color: rgba(200,210,224,0.5); }
body.light .fc-card-row:hover      { background: rgba(59,130,246,0.03); }
body.light .fc-card-row-front      { color: var(--text-muted); }
body.light .fc-card-row-btn        { border-color: var(--border); color: var(--text-dim); }
body.light .fc-card-row-btn.edit:hover { background: rgba(59,130,246,0.08); border-color: var(--blue); color: var(--blue); }
body.light .fc-card-row-btn.del:hover  { background: rgba(220,38,38,0.08); border-color: var(--red); color: var(--red); }
body.light .fc-acc-menu-btn        { color: var(--text-dim); }
body.light .fc-acc-menu-btn:hover  { background: var(--card); border-color: var(--border); color: var(--text-muted); }
body.light .fc-acc-menu-dropdown   { background: var(--surface); border-color: var(--border); box-shadow: 0 8px 24px rgba(15,30,60,0.12); }
body.light .fc-acc-menu-item       { color: var(--text-muted); }
body.light .fc-acc-menu-item:hover { background: rgba(15,30,60,0.04); color: var(--text); }
body.light .fc-acc-menu-item.danger       { color: var(--red); }
body.light .fc-acc-menu-item.danger:hover { background: rgba(239,68,68,0.06); }
body.light .fc-card-stats          { background: rgba(15,30,60,0.05); color: var(--text-dim); }
body.light .fc-menu-dropdown       { background: var(--surface); border-color: var(--border); box-shadow: 0 8px 24px rgba(15,30,60,0.12); }
body.light .fc-menu-item           { color: var(--text-muted); }
body.light .fc-menu-item:hover     { background: rgba(15,30,60,0.06); color: var(--text); }
body.light .fc-menu-item.danger    { color: var(--red); }
body.light .fc-menu-item.danger:hover { background: rgba(239,68,68,0.08); }
body.light .fc-menu-btn:hover      { background: rgba(15,30,60,0.06); }
body.light .fc-card-btn            { border-color: var(--border); color: var(--text-dim); }
body.light .fc-card-btn.edit:hover { background: rgba(59,130,246,0.10); border-color: var(--blue); color: var(--blue); }
body.light .fc-card-btn.del:hover  { background: rgba(239,68,68,0.10); border-color: var(--red); color: var(--red); }
body.light .bulk-cancel            { color: var(--text-muted); }
body.light .bulk-cancel:hover      { background: rgba(15,30,60,0.06); color: var(--text); }
body.light .fc-browse-loading      { color: var(--text-muted); }
body.light .fc-add-chapter-btn     { border-color: var(--border-lt); color: var(--text-dim); }
body.light .fc-add-chapter-btn:hover { border-color: var(--blue); color: var(--blue); }
body.light .fc-quick-add-form      { background: rgba(59,130,246,0.03); border-bottom-color: rgba(59,130,246,0.12); }
body.light .fc-quick-add-save  { background: var(--blue); color: #fff; }
body.light .fc-quick-add-cancel    { border-color: var(--border); color: var(--text-dim); }
body.light .fc-quick-add-type      { background: #fff; border-color: var(--border); color: var(--text-muted); }

/* ── CSV table ── */
body.light .csv-preview-table td { border-bottom-color: var(--border); color: var(--text-muted); }
body.light .csv-preview-table tr:hover td { background: rgba(59,130,246,0.03); }
body.light .csv-modal-sheet { background: var(--surface); border-color: var(--border); }
body.light .csv-textarea    { background: #fff; color: var(--text); border-color: var(--border); }

/* ── Edit card modal (review) ── */
body.light .edit-card-modal-sheet { background: var(--surface); border-color: var(--border); }
body.light .ecm-textarea    { background: #fff; color: var(--text); border-color: var(--border); }
body.light .n2c-modal-sheet { background: var(--surface); border-color: var(--border); }

/* ── Accuracy & review elements ── */
body.light #review-streak-badge { background: rgba(245,158,11,0.08); border-color: rgba(245,158,11,0.25); }
body.light .review-card-action-btn { background: var(--card); border-color: var(--border); color: var(--text-muted); }
body.light #review-kb-hint     { color: var(--text-dim); }
body.light #review-kb-hint kbd { background: var(--card); border-color: var(--border); }
body.light .gen-modal-box      { background: var(--surface); border-color: var(--border); box-shadow: 0 16px 48px rgba(15,30,60,0.12); }
body.light .gen-modal-title    { color: var(--text); }
body.light .gen-modal-body     { color: var(--text-muted); }
body.light .gen-modal-cancel   { background: var(--card); border-color: var(--border); color: var(--text-muted); }
body.light .gen-modal-backdrop { background: rgba(15,23,42,0.4); }
body.light .edit-card-modal-backdrop,
body.light .csv-modal-backdrop,
body.light .n2c-modal-backdrop { background: rgba(15,23,42,0.4); }

/* ── Notes: breadcrumb, headers ── */
body.light .notes-breadcrumb-bar  { background: var(--surface); border-bottom-color: var(--border); }
body.light .notes-bc-back         { background: var(--card); border-color: var(--border); color: var(--text-muted); }
body.light .notes-bc-back:hover   { color: var(--text); border-color: var(--border-lt); }
body.light .notes-bc-path         { color: var(--text-muted); }
body.light .notes-bc-sep          { color: var(--text-dim); }
body.light .notes-bc-crumb        { color: var(--text-muted); }
body.light .notes-bc-crumb.current { color: var(--text); }
body.light .notes-progress-track  { background: rgba(15,30,60,0.09); }

/* ── Notes: subject / unit / chapter cards ── */
body.light .notes-subj-card        { background: var(--card); border-color: var(--border); }
body.light .notes-subj-card:hover  { border-color: var(--border-lt); box-shadow: var(--shadow); }
body.light .notes-subj-card-name   { color: var(--text); }
body.light .notes-subj-card-badge  { background: rgba(15,30,60,0.06); color: var(--text-muted); }
body.light .notes-unit-grid-card   { background: var(--card); border-color: var(--border); }
body.light .notes-unit-grid-card:hover { border-color: var(--border-lt); box-shadow: var(--shadow-sm); }
body.light .notes-unit-grid-card-name  { color: var(--text); }
body.light .notes-unit-grid-card-badge { color: var(--text-muted); }
body.light .notes-unit-arrow       { color: var(--text-dim); }
body.light .notes-unit-bytype-btn  { background: rgba(59,130,246,0.07); color: var(--blue); border-color: rgba(59,130,246,0.2); }
body.light .notes-chap-card        { background: var(--card); border-color: var(--border); }
body.light .notes-chap-card:hover  { background: rgba(59,130,246,0.03); border-color: var(--border-lt); }
body.light .notes-chap-card.has-note { border-color: rgba(59,130,246,0.25); background: rgba(59,130,246,0.03); }
body.light .notes-chap-name        { color: var(--text); }
body.light .notes-chap-meta        { color: var(--text-dim); }
body.light .notes-chap-status.ns   { background: rgba(15,30,60,0.07); color: var(--text-dim); }
body.light .notes-section-head     { color: var(--text-dim); }
body.light .notes-unit-view        { }
body.light .notes-unit-card        { background: var(--card); border-color: var(--border); }
body.light .notes-unit-card:hover  { border-color: var(--border-lt); }
body.light .notes-unit-card-title  { color: var(--text); }
body.light .notes-unit-card-preview { color: var(--text-muted); }

/* ── Notes: search results ── */
body.light .notes-search-result-item       { background: var(--card); border-color: var(--border); }
body.light .notes-search-result-item:hover { border-color: var(--border-lt); }
body.light .notes-search-result-title  { color: var(--text); }
body.light .notes-search-result-path   { color: var(--text-muted); }
body.light .notes-search-result-preview { color: var(--text-dim); }

/* ── Notes: empty state ── */
body.light .notes-empty      { color: var(--text-muted); }
body.light .notes-empty-sub  { color: var(--text-dim); }

/* ── Notes: note view topbar ── */
body.light .notes-note-topbar         { background: var(--surface); border-bottom-color: var(--border); }
body.light .notes-note-topbar-title   { color: var(--text); }
body.light .notes-edit-btn            { background: var(--card); border-color: var(--border); color: var(--text-muted); }
body.light .notes-edit-btn:hover      { color: var(--blue); border-color: rgba(59,130,246,0.4); }
body.light .notes-edit-btn.active     { background: rgba(59,130,246,0.1); color: var(--blue); border-color: rgba(59,130,246,0.4); }
body.light .note-font-select          { background: var(--card); border-color: var(--border); color: var(--text-muted); }
body.light .note-font-select option   { background: #fff; color: var(--text); }

/* ── Notes: read body ── */
body.light .notes-read-body           { color: var(--text); }
body.light .notes-read-body h1,
body.light .notes-read-body h2,
body.light .notes-read-body h3        { color: var(--text); }
body.light .notes-read-body strong    { color: var(--text); }
body.light .notes-read-body th        { background: #edf2fa; color: var(--text-muted); }
body.light .notes-read-body td        { border-color: var(--border); }
body.light .notes-read-body code      { background: #e8eef7; color: #1e40af; }
body.light .notes-read-body pre       { background: #e8eef7; border: 1px solid var(--border); }
body.light .notes-read-body blockquote { border-left-color: var(--blue); color: var(--text-muted); }
body.light .notes-find-highlight      { background: rgba(250,204,21,0.45) !important; color: var(--text) !important; }

/* ── Notes: editor ── */
body.light .notes-editor-toolbar      { background: var(--surface); border-bottom-color: var(--border); }
body.light .notes-editor-toolbar input[type="text"] { background: transparent; color: var(--text); border-bottom-color: var(--border); }
body.light .notes-md-toolbar          { background: var(--surface); border-bottom-color: var(--border); }
body.light .md-btn                    { color: var(--text-muted); }
body.light .md-btn:hover              { background: var(--card); border-color: var(--border); color: var(--text); }
body.light .md-divider                { background: var(--border); }
body.light .notes-md-editor           { background: #f8faff; color: var(--text); }
body.light .notes-editor-footer       { background: var(--surface); border-top-color: var(--border); }
body.light .notes-tag-chip            { background: rgba(59,130,246,0.10); color: var(--blue); }
body.light .notes-tag-chip-x          { color: var(--text-dim); }
body.light .notes-tag-input           { color: var(--text); }
body.light #notes-save-status         { color: var(--text-dim); }

/* ── Notes: find bar ── */
body.light .notes-find-bar   { background: rgba(245,158,11,0.05); border-bottom-color: rgba(245,158,11,0.2); }
body.light .notes-find-input { background: #fff; border-color: rgba(245,158,11,0.4); color: var(--text); }
body.light .notes-find-count { color: var(--text-dim); }

/* ── Notes: recent panel ── */
body.light .notes-recent-panel  { border-bottom-color: var(--border); }
body.light .notes-recent-label  { color: var(--text-dim); }
body.light .notes-recent-chip   { background: var(--card); border-color: var(--border); color: var(--text); }
body.light .notes-recent-chip:hover { background: rgba(59,130,246,0.06); border-color: rgba(59,130,246,0.3); }
body.light .notes-recent-chip-sub { color: var(--text-dim); }

/* ── Notes: tag filter bar ── */
body.light .notes-tag-filter-bar   { background: var(--surface); border-bottom-color: var(--border); }
body.light .notes-tag-filter-label { color: var(--text-dim); }
body.light .notes-tag-pill         { background: var(--card); border-color: var(--border); color: var(--text-muted); }
body.light .notes-tag-pill:hover   { border-color: var(--blue); color: var(--blue); }
body.light .notes-tag-pill.active  { background: rgba(59,130,246,0.12); color: var(--blue); border-color: rgba(59,130,246,0.45); }

/* ── Notes: type-select grid ── */
body.light .notes-type-card        { background: var(--card); border-color: var(--border); }
body.light .notes-type-card:hover  { background: rgba(59,130,246,0.04); border-color: rgba(59,130,246,0.3); }
body.light .notes-type-card.has-note { border-color: rgba(59,130,246,0.3); background: rgba(59,130,246,0.04); }
body.light .notes-type-card-label  { color: var(--text); }
body.light .notes-type-card-desc   { color: var(--text-dim); }
body.light .notes-type-card-date   { color: var(--text-dim); }

/* ── Notes: right-side nav ── */
body.light #notes-rn-toggle        { background: var(--card); border-color: var(--border); color: var(--text-muted); box-shadow: -2px 0 8px rgba(15,30,60,0.08); }
body.light #notes-rn-toggle:hover  { color: var(--text); background: #edf2fa; }
body.light #notes-right-nav        { background: rgba(255,255,255,0.98); border-left-color: var(--border); box-shadow: -4px 0 24px rgba(15,30,60,0.09); }
body.light .notes-rn-header        { border-bottom-color: var(--border); }
body.light .notes-rn-close-btn     { border-color: var(--border); color: var(--text-dim); }
body.light .notes-rn-close-btn:hover { color: var(--text); }
body.light .notes-rn-subject-row   { color: var(--text-muted); }
body.light .notes-rn-subject-row:hover { color: var(--text); background: rgba(59,130,246,0.05); }
body.light .notes-rn-subject-row.active { color: var(--blue); background: rgba(59,130,246,0.07); }
body.light .notes-rn-unit-head     { color: var(--text-dim); }
body.light .notes-rn-unit-head:hover { color: var(--text-muted); background: rgba(59,130,246,0.04); }
body.light .notes-rn-unit-head.active { color: var(--blue); }
body.light .notes-rn-unit-count    { background: rgba(15,30,60,0.07); color: var(--text-dim); }
body.light .notes-rn-chapter       { color: var(--text-dim); }
body.light .notes-rn-chapter:hover { color: var(--text-muted); background: rgba(59,130,246,0.04); }
body.light .notes-rn-chapter.has-note { color: var(--text-muted); }
body.light .notes-rn-chapter.active { color: var(--blue); background: rgba(59,130,246,0.08); border-left-color: var(--blue); }
body.light .notes-rn-chapter-dot  { background: var(--border-lt); }
body.light .notes-rn-chapter.has-note .notes-rn-chapter-dot { background: var(--blue); opacity: 0.6; }
body.light .notes-rn-chapter.active .notes-rn-chapter-dot   { background: var(--blue); opacity: 1; }

/* ── Browse bulk action bar ── */
body.light .browse-bulk-bar {
  background: rgba(238,242,247,0.97);
  backdrop-filter: blur(16px);
  border-top-color: var(--border);
}
body.light .browse-bulk-count  { color: var(--text); }
body.light .browse-bulk-cancel { background: var(--card); color: var(--text-muted); border-color: var(--border); }

/* ── Toolbar tool buttons ── */
body.light .toolbar-tool-btn        { background: var(--card); border-color: var(--border); color: var(--text-muted); }
body.light .toolbar-tool-btn:hover  { color: var(--text); border-color: var(--border-lt); }
body.light .toolbar-tool-btn.ai     { color: var(--blue); border-color: rgba(59,130,246,0.25); }
body.light .toolbar-tool-btn.ai:hover { background: rgba(59,130,246,0.08); }

/* ── Global popup system ── */
body.light .gs-toast {
  background: #ffffff;
  border: 1px solid var(--border-lt);
  border-left: 3px solid var(--border-lt);
  color: var(--text);
  box-shadow: 0 8px 32px rgba(15,30,60,0.13);
}
body.light .gs-toast.gs-success { border-left-color: var(--green); }
body.light .gs-toast.gs-error   { border-left-color: var(--red); }
body.light .gs-toast.gs-warn    { border-left-color: var(--yellow); }
body.light .gs-toast.gs-info    { border-left-color: var(--blue); }
body.light .gs-modal-backdrop   { background: rgba(10,20,50,0.45); backdrop-filter: blur(3px); }
body.light .gs-modal-box {
  background: #ffffff;
  border: 1px solid var(--border);
  box-shadow: 0 24px 64px rgba(15,30,60,0.14);
}
body.light .gs-modal-title    { color: var(--text); }
body.light .gs-modal-body     { color: var(--text-muted); }
body.light .gs-btn-cancel     { background: var(--card); border-color: var(--border); color: var(--text-muted); }
body.light .gs-btn-cancel:hover { background: #e8eef7; color: var(--text); }
body.light .gs-prompt-input   { background: #f8faff; border-color: var(--border-lt); color: var(--text); }
body.light .gs-prompt-input:focus { border-color: var(--blue); }

/* ── Misc IDs ── */
body.light #userGreeting  { color: var(--text); }
body.light #authStatus    { color: var(--text-dim); }

/* ── Scrollbar ── */
body.light ::-webkit-scrollbar-thumb { background: rgba(100,130,170,0.35); }
body.light ::-webkit-scrollbar-track { background: transparent; }

/* ── Touch active states (light inversion) ── */
@media (hover: none) {
  body.light .card:active,
  body.light .subject-summary-card:active { background: rgba(59,130,246,0.04); border-color: rgba(59,130,246,0.2); }
  body.light .fc-browse-item:active       { background: rgba(59,130,246,0.04); }
  body.light .notes-recent-chip:active    { background: rgba(59,130,246,0.07); border-color: rgba(59,130,246,0.3); }
  body.light .notes-rn-chapter:active     { background: rgba(59,130,246,0.06); }
  body.light .notes-rn-unit-head:active   { background: rgba(59,130,246,0.04); }
}

/* ═══════════════════════════════════════════════════════════════
   LIGHT MODE — Inline Style Overrides (JS-generated HTML)
   These use !important to override hardcoded inline style=""
   attributes that CSS cannot normally beat.
   ═══════════════════════════════════════════════════════════════ */

/* Generic dark surface patterns used throughout analytics.js / app.js */
body.light [style*="background:#0f172a"],
body.light [style*="background: #0f172a"] {
  background: var(--card) !important;
  color: var(--text) !important;
}
body.light [style*="background:#1e293b"],
body.light [style*="background: #1e293b"] {
  background: var(--surface) !important;
  border-color: var(--border) !important;
}
body.light [style*="background:#111f38"],
body.light [style*="background: #111f38"] {
  background: var(--surface) !important;
}
body.light [style*="background:#152030"],
body.light [style*="background: #152030"] {
  background: var(--card) !important;
}
body.light [style*="background:#0a1628"],
body.light [style*="background: #0a1628"] {
  background: var(--card) !important;
}
body.light [style*="background:#1a2840"],
body.light [style*="background: #1a2840"] {
  background: var(--card) !important;
}

/* Dark green success panels (evening submitted, streak) */
body.light [style*="background:#0f2b1a"],
body.light [style*="background: #0f2b1a"],
body.light [style*="background:linear-gradient(135deg,#0f2b1a"],
body.light [style*="background: linear-gradient(135deg, #0f2b1a"] {
  background: linear-gradient(135deg,#f0fdf4,#dcfce7) !important;
  color: #14532d !important;
}
body.light [style*="background:#0a2b15"],
body.light [style*="background: #0a2b15"] {
  background: #dcfce7 !important;
  color: #14532d !important;
}
body.light [style*="background:#1a2e0a"],
body.light [style*="background: #1a2e0a"] {
  background: #f0fdf4 !important;
  border-color: #86efac !important;
  color: #15803d !important;
}
body.light [style*="background:#1a3a1a"],
body.light [style*="background: #1a3a1a"] {
  background: rgba(16,185,129,0.08) !important;
}

/* Dark red danger panels */
body.light [style*="background:#450a0a"],
body.light [style*="background: #450a0a"] {
  background: #fff1f2 !important;
  color: #dc2626 !important;
  border-color: #ef4444 !important;
}
body.light [style*="background:#1a0a0a"],
body.light [style*="background: #1a0a0a"] {
  background: #fff1f2 !important;
  color: #dc2626 !important;
  border-color: #fca5a5 !important;
}

/* Dark blue panels */
body.light [style*="background:#1e3a5f"],
body.light [style*="background: #1e3a5f"] {
  background: rgba(59,130,246,0.1) !important;
  color: #1d4ed8 !important;
}
body.light [style*="background:#0f2d4a"],
body.light [style*="background: #0f2d4a"] {
  background: #eff6ff !important;
  color: #1d4ed8 !important;
  border-color: #93c5fd !important;
}
body.light [style*="background:#2e1a5e"],
body.light [style*="background: #2e1a5e"] {
  background: rgba(139,92,246,0.1) !important;
  color: #7c3aed !important;
}
body.light [style*="background:#3b2200"],
body.light [style*="background: #3b2200"] {
  background: rgba(245,158,11,0.1) !important;
  color: #b45309 !important;
}
body.light [style*="background:#431407"],
body.light [style*="background: #431407"] {
  background: rgba(249,115,22,0.1) !important;
  color: #c2410c !important;
}

/* Dark bg with green gradient for streak boxes */
body.light [style*="background:linear-gradient(135deg,#0f2b1a,#0a1f12)"],
body.light [style*="background: linear-gradient(135deg, #0f2b1a, #0a1f12)"],
body.light [style*="background:linear-gradient(135deg, #0f2b1a"],
body.light [style*="background:linear-gradient(135deg,#0f2b1a"] {
  background: linear-gradient(135deg,#f0fdf4,#dcfce7) !important;
  border-color: #16a34a !important;
}

/* Code tags with dark backgrounds (setup.html, editor.html inline snippets) */
body.light code[style*="background:#1e293b"],
body.light code[style*="background: #1e293b"] {
  background: #e8eef7 !important;
  color: #0f172a !important;
}

/* text colors that look bad on light bg */
body.light [style*="color:#a8c0dc"] { color: var(--text-muted) !important; }
body.light [style*="color:#f0f6ff"] { color: var(--text) !important; }
body.light [style*="color:#94a3b8"] { color: var(--text-dim) !important; }
body.light [style*="color:#cbd5e1"] { color: var(--text-muted) !important; }
body.light [style*="color:#e2e8f0"] { color: var(--text) !important; }
body.light [style*="color:#f1f5f9"] { color: var(--text) !important; }

/* Dark border colors hardcoded inline */
body.light [style*="border:1px solid #1e293b"],
body.light [style*="border: 1px solid #1e293b"] {
  border-color: var(--border) !important;
}
body.light [style*="border:1px solid #1e3350"],
body.light [style*="border: 1px solid #1e3350"] {
  border-color: var(--border) !important;
}
body.light [style*="border-top:1px solid #1e293b"],
body.light [style*="border-top: 1px solid #1e293b"] {
  border-top-color: var(--border) !important;
}
body.light [style*="border-bottom:1px solid #1a3a1a"],
body.light [style*="border-bottom: 1px solid #1a3a1a"] {
  border-bottom-color: var(--border) !important;
}
body.light [style*="border-left:2px solid #ef4444"] {
  border-left-color: #ef4444 !important;
}
body.light [style*="border-bottom:1px solid #0f172a"],
body.light [style*="border-bottom: 1px solid #0f172a"] {
  border-bottom-color: var(--border) !important;
}

/* Revision list row backgrounds */
body.light [style*="border-top:1px solid #1e3350"] {
  border-top-color: var(--border) !important;
}

/* White-rgba hover states (were invisible on dark) — now properly themed */
body.light [style*="background:rgba(255,255,255,0.03)"] { background: transparent !important; }
body.light [style*="background:rgba(255,255,255,0.04)"] { background: rgba(59,130,246,0.04) !important; }
body.light [style*="background:rgba(255,255,255,0.05)"] { background: rgba(59,130,246,0.05) !important; }
body.light [style*="background:rgba(255,255,255,0.07)"] { background: rgba(59,130,246,0.06) !important; }

/* Qbank review button base (background:#0f172a with colored borders) */
body.light button[style*="background:#0f172a"] {
  background: var(--card) !important;
}

/* Dark subject-tab-like links */
body.light a[style*="background:#1e293b"],
body.light a[style*="background: #1e293b"] {
  background: var(--surface) !important;
  border: 1px solid var(--border) !important;
}
body.light a[style*="background:#1e3a5f"] {
  background: rgba(59,130,246,0.1) !important;
}

/* Analytics subject-acc tabs (inline bg toggled by JS) */
body.light div[style*="background:#0f172a;color:#64748b"],
body.light div[style*="background:#0f172a; color:#64748b"] {
  background: var(--card) !important;
  color: var(--text-dim) !important;
}
body.light div[style*="background:#1e3a5f;color:#93c5fd"],
body.light div[style*="background:#1e3a5f; color:#93c5fd"] {
  background: rgba(59,130,246,0.14) !important;
  color: #1d4ed8 !important;
}

/* Textarea in evening update with dark bg */
body.light textarea[style*="background:#0a1628"] {
  background: #f8faff !important;
  border-color: var(--border) !important;
  color: var(--text) !important;
}

/* Form sections in app.js */
body.light div[style*="background:#0f172a;border-radius:12px"],
body.light div[style*="background:#0f172a; border-radius:12px"] {
  background: var(--surface) !important;
  border-color: var(--border) !important;
}

/* Phase chip badges */
body.light span[style*="background:#1e3a5f;color:#60a5fa"] {
  background: rgba(59,130,246,0.1) !important;
  color: #1d4ed8 !important;
}
body.light span[style*="background:#1e3a5f;color:#93c5fd"] {
  background: rgba(59,130,246,0.1) !important;
  color: #1d4ed8 !important;
}
body.light span[style*="background:#1e293b;color:#93c5fd"] {
  background: rgba(59,130,246,0.1) !important;
  color: #1d4ed8 !important;
}
body.light span[style*="background:#1e293b;color:#86efac"] {
  background: rgba(16,185,129,0.1) !important;
  color: #15803d !important;
}
body.light span[style*="background:#1e293b;color:#c4b5fd"] {
  background: rgba(139,92,246,0.1) !important;
  color: #7c3aed !important;
}
body.light span[style*="background:#0f2b1a;color:#4ade80"] {
  background: rgba(16,185,129,0.1) !important;
  color: #15803d !important;
}

/* Subject module time tracking divs */
body.light div[style*="background:#0f172a;border-radius:10px;padding:10px;margin-bottom:12px"] {
  background: var(--surface) !important;
  border-color: var(--border) !important;
}

/* The "review.html" rating labels colored spans */
body.light span[style*="color:#334155;background"] {
  color: var(--text-muted) !important;
}

/* Study entry rows inside evening update */
body.light div[style*="border:1px solid #1e293b;border-radius:10px;padding:12px;margin-bottom:10px;background:#0a1628"] {
  background: var(--surface) !important;
  border-color: var(--border) !important;
}

/* Phase done badge chips in analytics subject ranking */
body.light span[style*="background:#1e3a5f;color:#60a5fa;padding:2px 7px"] {
  background: rgba(59,130,246,0.1) !important;
  color: #2563eb !important;
}

/* Weekly report day dots with dark gray (no activity) */
body.light div[style*="background:#1f2937;margin:0 auto"] {
  background: #dde3ed !important;
}

/* "Needs attention" section dividers */
body.light div[style*="border-bottom:1px solid #0f172a"],
body.light div[style*="border-bottom: 1px solid #0f172a"] {
  border-bottom-color: var(--border) !important;
}

/* Overdue section separators */
body.light div[style*="border-left:2px solid #ef4444"] {
  border-left-color: #ef4444 !important; /* keep red */
}

/* Profile page inline code tags */
body.light code[style*="background:#0f172a"] {
  background: var(--card) !important;
  color: var(--text) !important;
  border: 1px solid var(--border);
}

/* "View Full Report" analytics link */
body.light a[style*="background:#1e293b;color:#93c5fd"] {
  background: rgba(59,130,246,0.1) !important;
  color: #1d4ed8 !important;
}

/* ── Planner CTA card ── */
.planner-cta-card {
  background: linear-gradient(135deg,#0f2541,#1a3a5f);
}
body.light .planner-cta-card {
  background: linear-gradient(135deg,#eff6ff,#dbeafe);
}
body.light .planner-cta-card [style*="color:#93c5fd"] { color: #2563eb !important; }
body.light .planner-cta-card [style*="color:#64748b"] { color: #455368 !important; }

/* ── App.js countdown / danger banners (inline cssText set via JS) ── */
/* These use cssTex = "background:linear-gradient(135deg,#450a0a..." */
body.light #countdownBanner,
body.light [class*="countdown"] {
  background: linear-gradient(135deg,#fff1f2,#fee2e2) !important;
  border-color: #ef4444 !important;
  color: #dc2626 !important;
}
/* rgba(0,0,0,0.3) overlay divs inside banners */
body.light [style*="background:rgba(0,0,0,0.3)"],
body.light [style*="background: rgba(0,0,0,0.3)"] {
  background: rgba(0,0,0,0.06) !important;
}
body.light [style*="background:rgba(0,0,0,0.4)"],
body.light [style*="background: rgba(0,0,0,0.4)"] {
  background: rgba(0,0,0,0.06) !important;
}
body.light [style*="background:rgba(0,0,0,0.5)"],
body.light [style*="background: rgba(0,0,0,0.5)"] {
  background: rgba(0,0,0,0.04) !important;
}

/* Revision list row separator */
body.light [style*="border-top:1px solid #1e3350"] {
  border-top-color: var(--border) !important;
}
body.light [style*="border-top: 1px solid #1e3350"] {
  border-top-color: var(--border) !important;
}

/* Additional green gradient panels (evening update cards) */
body.light [style*="background:#0a2b15;border-radius"] {
  background: #dcfce7 !important;
  color: #14532d !important;
}

/* "1e3a5f" border inline */
body.light [style*="border:1px solid #1e3a5f"],
body.light [style*="border: 1px solid #1e3a5f"] {
  border-color: rgba(59,130,246,0.3) !important;
}

/* "liveTimeHtml" time tracking panel border override */
body.light [style*="border:1px solid #1e3a5f;"] {
  border-color: rgba(59,130,246,0.3) !important;
}

/* Small color:#334155 text that's too dark on light backgrounds */
body.light [style*="color:#334155"] { color: var(--text-dim) !important; }

/* profile.html settings box */
body.light [style*="background:#0f172a;border-radius:10px;padding:12px;margin-bottom:16px;border:1px solid #1e293b"] {
  background: var(--surface) !important;
  border-color: var(--border) !important;
}

/* Profile code inline tag */
body.light code[style*="background:#0f172a;padding:1px"] {
  background: var(--card) !important;
  border: 1px solid var(--border) !important;
  color: var(--text) !important;
}

/* study entry card wrapper */
body.light [style*="border:1px solid #1e293b;border-radius:10px;padding:12px;margin-bottom:10px"] {
  background: var(--surface) !important;
  border-color: var(--border) !important;
}

/* "+Add Another Subject" buttons */
body.light [style*="background:#1e3a5f;color:#93c5fd;font-size:12px;padding:9px"] {
  background: rgba(59,130,246,0.1) !important;
  color: #1d4ed8 !important;
}
body.light [style*="background:#1a2e1a;color:#86efac;font-size:12px;padding:9px"] {
  background: rgba(16,185,129,0.1) !important;
  color: #15803d !important;
}

/* "Fill from plan" button */
body.light [style*="background:#1e3a2f;color:#86efac"] {
  background: rgba(16,185,129,0.1) !important;
  color: #15803d !important;
  border-color: #16a34a !important;
}

/* Evening warning div */
body.light [style*="background:#450a0a;border:1px solid #7f1d1d"] {
  background: #fff1f2 !important;
  border-color: #fca5a5 !important;
  color: #dc2626 !important;
}

/* Analytics: "subjects covered" chips */
body.light span[style*="background:#1e3a5f;color:#93c5fd;padding:3px 8px;border-radius:6px;font-size:11px"] {
  background: rgba(59,130,246,0.1) !important;
  color: #1d4ed8 !important;
}

/* Analytics heatmap legend "None" swatch */
body.light span span[style*="background:#1f2937;border-radius:2px"] {
  background: #dde3ed !important;
}

/* ── JS Class-based overrides (elements get className from JS) ── */
.app-countdown-banner { background: linear-gradient(135deg,#450a0a,#7f1d1d); }
body.light .app-countdown-banner {
  background: linear-gradient(135deg,#fff1f2,#fee2e2) !important;
  border-color: #ef4444 !important;
  color: #dc2626 !important;
}
body.light .app-countdown-banner [style*="color:#fca5a5"] { color: #dc2626 !important; }

.app-streak-banner { /* orange streak banner */ }
body.light .app-streak-banner {
  background: linear-gradient(135deg,#fff7ed,#fed7aa) !important;
  color: #9a3412 !important;
}
body.light .app-streak-banner [style*="color:white"] { color: #9a3412 !important; }
body.light .app-streak-banner [style*="color:#fed7aa"] { color: #c2410c !important; }

.js-dark-gradient-btn {
  /* Flashcard due widget — dark blue gradient (index page) */
}
body.light .js-dark-gradient-btn {
  background: linear-gradient(135deg,#eff6ff,#dbeafe) !important;
  border-color: #93c5fd !important;
}
body.light .js-dark-gradient-btn [style*="color:#93c5fd"] { color: #1d4ed8 !important; }
body.light .js-dark-gradient-btn [style*="color:#e2e8f0"] { color: #0f172a !important; }

.rev-list-wrap {
  border: 1px solid #1e3350;
  border-radius: 8px;
}
body.light .rev-list-wrap {
  border-color: var(--border) !important;
}

.study-entry-row {
  border: 1px solid #1e293b;
  border-radius: 10px;
  padding: 12px;
  margin-bottom: 10px;
  background: #0a1628;
}
body.light .study-entry-row {
  background: var(--surface) !important;
  border-color: var(--border) !important;
}

.rev-checkbox-label {
  display: block;
  padding: 6px 8px;
  font-size: 13px;
  cursor: pointer;
  border-bottom: 1px solid #1e293b;
}
body.light .rev-checkbox-label {
  border-bottom-color: var(--border) !important;
  color: var(--text) !important;
}


/* ── Keyboard shortcut hints (review.html) ── */
.kbd-hint {
  font-size: 10px;
  color: #64748b;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 5px;
  padding: 2px 7px;
  display: inline-block;
}
body.light .kbd-hint {
  color: #455368;
  background: #f4f7fb;
  border-color: #c4cfe0;
}

/* ════════════════════════════════════════════════════════════
   LIGHT MODE — scheduler.js Smart Planner HTML overrides
   (S1–S7, R1–R8, FC1–FC5, QBank IQ engine)
   All new JS-generated inline styles targeted here.
   ════════════════════════════════════════════════════════════ */

/* Summary bar gradient (top + pre-exam version) */
body.light [style*="background:linear-gradient(135deg,#1e293b,#0f172a)"],
body.light [style*="background: linear-gradient(135deg, #1e293b, #0f172a)"] {
  background: linear-gradient(135deg, #f1f5f9, #e8edf5) !important;
  border-color: var(--border) !important;
}

/* Darkest navy #0a0f1a — Batch 2 dashed container */
body.light [style*="background:#0a0f1a"],
body.light [style*="background: #0a0f1a"] {
  background: var(--card) !important;
}
body.light [style*="border:1px dashed #334155"],
body.light [style*="border: 1px dashed #334155"] {
  border-color: var(--border-lt) !important;
}

/* Deep purple navy #1e1a3a — QBank pairing banner */
body.light [style*="background:#1e1a3a"],
body.light [style*="background: #1e1a3a"] {
  background: rgba(139,92,246,0.08) !important;
}
body.light [style*="border:1px solid #6d28d9"],
body.light [style*="border: 1px solid #6d28d9"] {
  border-color: rgba(139,92,246,0.40) !important;
}

/* Very dark navy #1a1a2e — Batch split banner + interleave block */
body.light [style*="background:#1a1a2e"],
body.light [style*="background: #1a1a2e"] {
  background: rgba(99,102,241,0.06) !important;
}
body.light [style*="border:1px solid #4f46e5"],
body.light [style*="border: 1px solid #4f46e5"] {
  border-color: rgba(99,102,241,0.35) !important;
}

/* Dark orange #422006 — tomorrow warn, evening tag, FC split warn, overdue moderate */
body.light [style*="background:#422006"],
body.light [style*="background: #422006"] {
  background: rgba(249,115,22,0.08) !important;
  color: #c2410c !important;
}

/* Dark red #3b1515 — quality score 2 btn, EF low badge */
body.light [style*="background:#3b1515"],
body.light [style*="background: #3b1515"] {
  background: rgba(239,68,68,0.08) !important;
  color: #dc2626 !important;
}

/* Dark green #0f3a1a — quality score 4 btn */
body.light [style*="background:#0f3a1a"],
body.light [style*="background: #0f3a1a"] {
  background: rgba(16,185,129,0.09) !important;
  color: #047857 !important;
}

/* Dark teal-blue #0f2a3a — quality score 5 btn */
body.light [style*="background:#0f2a3a"],
body.light [style*="background: #0f2a3a"] {
  background: rgba(59,130,246,0.09) !important;
  color: #1d4ed8 !important;
}

/* Medium dark green #0f2a1a — FC same-session subject pill */
body.light [style*="background:#0f2a1a"],
body.light [style*="background: #0f2a1a"] {
  background: rgba(16,185,129,0.10) !important;
  color: #15803d !important;
}

/* Rev row bottom separator — border-bottom:#0f172a */
body.light [style*="border-bottom:1px solid #0f172a"],
body.light [style*="border-bottom: 1px solid #0f172a"] {
  border-bottom-color: var(--border) !important;
}

/* Rev group header top border — border-top:#0f172a */
body.light [style*="border-top:1px solid #0f172a"],
body.light [style*="border-top: 1px solid #0f172a"] {
  border-top-color: var(--border) !important;
}

/* Rev row "next revision date" badge — background:#1e293b;color:#93c5fd */
body.light [style*="background:#1e293b;color:#93c5fd;padding:1px 5px;border-radius:4px"] {
  background: rgba(59,130,246,0.1) !important;
  color: #1d4ed8 !important;
}

/* Session order bar pills — background:#1e293b;color:#94a3b8;...border:1px solid #334155 */
body.light [style*="background:#1e293b;color:#94a3b8;padding:3px 10px;border-radius:8px"] {
  background: var(--card) !important;
  color: var(--text-muted) !important;
  border-color: var(--border) !important;
}

/* First recall badge + Resume badge + "Continued" badge: bg:#1a3a1a already maps
   to rgba(16,185,129,0.08) in existing rule — fix text color #4ade80 on light bg */
body.light [style*="background:#1a3a1a;color:#4ade80"] {
  color: #15803d !important;
}
body.light [style*="border:1px solid #166534"] {
  border-color: #16a34a !important;
}

/* R8 memory-at-risk badge: bg:#450a0a (→ #fff1f2 from existing) + border fix */
body.light [style*="border:1px solid #ef444433"] {
  border-color: rgba(239,68,68,0.30) !important;
}

/* Light text colors that are illegible on light backgrounds */
body.light [style*="color:#c4b5fd"] { color: #7c3aed !important; }  /* qbank banner text */
body.light [style*="color:#a5b4fc"] { color: #4f46e5 !important; }  /* interleave header */
body.light [style*="color:#6366f1"] { color: #4338ca !important; }  /* interleave sub-text */

/* FC2 same-session note text color (#16a34a green) — stays readable on light */
/* FC breakdown "other subject" pill already covered by #0a1628 / #1e293b rules */

/* sec-subject divider label — color:#f59e0b stays readable */
/* burnout/todProfile colors (#ef4444, #10b981, #f59e0b) — semantic, stay as-is */

